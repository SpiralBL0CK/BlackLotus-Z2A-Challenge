import sys
import math
import re
from pwn import * 
from dumpulator import Dumpulator
from solve_hash_syscalls import iterate_over_module_name_and_hash
from solve_hash_syscalls import some_hash_0x1003F


def aplib_decompress(base,binar_ntdll, a2, a3):
    """
    a2 = hash
    a3 = return val i guess
    base = baza pt binar aicia e useless
    binar_ntdll = binary catre ntdll
    """
    v34 = a2
    v5 = 0
    v6 = 0
    v33 = 0
    v32 = [None for i in range(0x208)]
    v7 = 260
    v30 = [None for i in range(0x104)]
    mz_header = binar[0:2]
    if(mz_header == b'MZ'):
        mz_header_binary = binar
        print("aici")
        pe_heder =  binar[binar[0x3c]:]
        print(a3)
        if(pe_heder):
            #print(hexdump(pe_heder[0x8c:]))
            if(pe_heder[0x8c:] != ""):
                esi = pe_heder[0x88:0x8c]
                esi = int.from_bytes(esi,"little")
                #print(hex(esi))
                #esi = hex(esi)[:-4:-1]
                #esi = int("0x"+(esi[::-1]),base=16)
                rsi = binar_ntdll[esi:]
                eax = rsi[0x24:0x28]
                eax = int.from_bytes(eax,"little")
                rax = binar_ntdll[eax:]
                #print(hexdump(rax))
                alphabet = rax
                eax = rsi[0x20:0x24]
                eax = int.from_bytes(eax,"little")
                rax = binar[eax:]
                #print(hexdump(rax))
                if(a2):
                    r12d = 0
                    #print(rsi[0x18:])
                    temp = int.from_bytes(rsi[0x18:0x1c],"little")
                    #print(hex(temp))
                    if(temp > 0):
                        ebx = 0 
                        currnt_str = ""
                        neprocesat = []
                        raw_string = "A_SHAFinal\x00A_SHAInit\x00A_SHAUpdate\x00AlpcAdjustCompletionListConcurrencyCount\x00AlpcFreeCompletionListMessage\x00AlpcGetCompletionListLastMessageInformation\x00AlpcGetCompletionListMessageAttributes\x00AlpcGetHeaderSize\x00AlpcGetMessageAttribute\x00AlpcGetMessageFromCompletionList\x00AlpcGetOutstandingCompletionListMessageCount\x00AlpcInitializeMessageAttribute\x00AlpcMaxAllowedMessageLength\x00AlpcRegisterCompletionList\x00AlpcRegisterCompletionListWorkerThread\x00AlpcRundownCompletionList\x00AlpcUnregisterCompletionList\x00AlpcUnregisterCompletionListWorkerThread\x00CsrAllocateCaptureBuffer\x00CsrAllocateMessagePointer\x00CsrCaptureMessageBuffer\x00CsrCaptureMessageMultiUnicodeStringsInPlace\x00CsrCaptureMessageString\x00CsrCaptureTimeout\x00CsrClientCallServer\x00CsrClientConnectToServer\x00CsrFreeCaptureBuffer\x00CsrGetProcessId\x00CsrIdentifyAlertableThread\x00CsrSetPriorityClass\x00CsrVerifyRegion\x00DbgBreakPoint\x00DbgPrint\x00DbgPrintEx\x00DbgPrintReturnControlC\x00DbgPrompt\x00DbgQueryDebugFilterState\x00DbgSetDebugFilterState\x00DbgUiConnectToDbg\x00DbgUiContinue\x00DbgUiConvertStateChangeStructure\x00DbgUiDebugActiveProcess\x00DbgUiGetThreadDebugObject\x00DbgUiIssueRemoteBreakin\x00DbgUiRemoteBreakin\x00DbgUiSetThreadDebugObject\x00DbgUiStopDebugging\x00DbgUiWaitStateChange\x00DbgUserBreakPoint\x00EtwCreateTraceInstanceId\x00EtwDeliverDataBlock\x00EtwEnumerateProcessRegGuids\x00EtwEventActivityIdControl\x00EtwEventEnabled\x00EtwEventProviderEnabled\x00EtwEventRegister\x00EtwEventSetInformation\x00EtwEventUnregister\x00EtwEventWrite\x00EtwEventWriteEndScenario\x00EtwEventWriteEx\x00EtwEventWriteFull\x00EtwEventWriteNoRegistration\x00EtwEventWriteStartScenario\x00EtwEventWriteString\x00EtwEventWriteTransfer\x00EtwGetTraceEnableFlags\x00EtwGetTraceEnableLevel\x00EtwGetTraceLoggerHandle\x00EtwLogTraceEvent\x00EtwNotificationRegister\x00EtwNotificationUnregister\x00EtwProcessPrivateLoggerRequest\x00EtwRegisterSecurityProvider\x00EtwRegisterTraceGuidsA\x00EtwRegisterTraceGuidsW\x00EtwReplyNotification\x00EtwSendNotification\x00EtwSetMark\x00EtwTraceEventInstance\x00EtwTraceMessage\x00EtwTraceMessageVa\x00EtwUnregisterTraceGuids\x00EtwWriteUMSecurityEvent\x00EtwpCreateEtwThread\x00EtwpGetCpuSpeed\x00EtwpNotificationThread\x00EvtIntReportAuthzEventAndSourceAsync\x00EvtIntReportEventAndSourceAsync\x00ExpInterlockedPopEntrySListEnd\x00ExpInterlockedPopEntrySListEnd16\x00ExpInterlockedPopEntrySListFault\x00ExpInterlockedPopEntrySListFault16\x00ExpInterlockedPopEntrySListResume\x00ExpInterlockedPopEntrySListResume16\x00KiRaiseUserExceptionDispatcher\x00KiUserApcDispatcher\x00KiUserCallbackDispatcher\x00KiUserExceptionDispatcher\x00LdrAccessResource\x00LdrAddLoadAsDataTable\x00LdrAddRefDll\x00LdrDisableThreadCalloutsForDll\x00LdrEnumResources\x00LdrEnumerateLoadedModules\x00LdrFindEntryForAddress\x00LdrFindResourceDirectory_U\x00LdrFindResourceEx_U\x00LdrFindResource_U\x00LdrFlushAlternateResourceModules\x00LdrGetDllHandle\x00LdrGetDllHandleByMapping\x00LdrGetDllHandleByName\x00LdrGetDllHandleEx\x00LdrGetFailureData\x00LdrGetFileNameFromLoadAsDataTable\x00LdrGetKnownDllSectionHandle\x00LdrGetProcedureAddress\x00LdrGetProcedureAddressEx\x00LdrHotPatchRoutine\x00LdrInitShimEngineDynamic\x00LdrInitializeThunk\x00LdrLoadAlternateResourceModule\x00LdrLoadAlternateResourceModuleEx\x00LdrLoadDll\x00LdrLockLoaderLock\x00LdrOpenImageFileOptionsKey\x00LdrProcessInitializationComplete\x00LdrProcessRelocationBlock\x00LdrQueryImageFileExecutionOptions\x00LdrQueryImageFileExecutionOptionsEx\x00LdrQueryImageFileKeyOption\x00LdrQueryModuleServiceTags\x00LdrQueryProcessModuleInformation\x00LdrRegisterDllNotification\x00LdrRemoveLoadAsDataTable\x00LdrResFindResource\x00LdrResFindResourceDirectory\x00LdrResGetRCConfig\x00LdrResRelease\x00LdrResSearchResource\x00LdrRscIsTypeExist\x00LdrSetAppCompatDllRedirectionCallback\x00LdrSetDllManifestProber\x00LdrSetMUICacheType\x00LdrShutdownProcess\x00LdrShutdownThread\x00LdrSystemDllInitBlock\x00LdrUnloadAlternateResourceModule\x00LdrUnloadAlternateResourceModuleEx\x00LdrUnloadDll\x00LdrUnlockLoaderLock\x00LdrUnregisterDllNotification\x00LdrVerifyImageMatchesChecksum\x00LdrVerifyImageMatchesChecksumEx\x00LdrpResGetMappingSize\x00LdrpResGetResourceDirectory\x00MD4Final\x00MD4Init\x00MD4Update\x00MD5Final\x00MD5Init\x00MD5Update\x00NlsAnsiCodePage\x00NlsMbCodePageTag\x00NlsMbOemCodePageTag\x00NtAcceptConnectPort\x00NtAccessCheck\x00NtAccessCheckAndAuditAlarm\x00NtAccessCheckByType\x00NtAccessCheckByTypeAndAuditAlarm\x00NtAccessCheckByTypeResultList\x00NtAccessCheckByTypeResultListAndAuditAlarm\x00NtAccessCheckByTypeResultListAndAuditAlarmByHandle\x00NtAddAtom\x00NtAddBootEntry\x00NtAddDriverEntry\x00NtAdjustGroupsToken\x00NtAdjustPrivilegesToken\x00NtAlertResumeThread\x00NtAlertThread\x00NtAllocateLocallyUniqueId\x00NtAllocateReserveObject\x00NtAllocateUserPhysicalPages\x00NtAllocateUuids\x00NtAllocateVirtualMemory\x00NtAlpcAcceptConnectPort\x00NtAlpcCancelMessage\x00NtAlpcConnectPort\x00NtAlpcCreatePort\x00NtAlpcCreatePortSection\x00NtAlpcCreateResourceReserve\x00NtAlpcCreateSectionView\x00NtAlpcCreateSecurityContext\x00NtAlpcDeletePortSection\x00NtAlpcDeleteResourceReserve\x00NtAlpcDeleteSectionView\x00NtAlpcDeleteSecurityContext\x00NtAlpcDisconnectPort\x00NtAlpcImpersonateClientOfPort\x00NtAlpcOpenSenderProcess\x00NtAlpcOpenSenderThread\x00NtAlpcQueryInformation\x00NtAlpcQueryInformationMessage\x00NtAlpcRevokeSecurityContext\x00NtAlpcSendWaitReceivePort\x00NtAlpcSetInformation\x00NtApphelpCacheControl\x00NtAreMappedFilesTheSame\x00NtAssignProcessToJobObject\x00NtCallbackReturn\x00NtCancelIoFile\x00NtCancelIoFileEx\x00NtCancelSynchronousIoFile\x00NtCancelTimer\x00NtClearEvent\x00NtClose\x00NtCloseObjectAuditAlarm\x00NtCommitComplete\x00NtCommitEnlistment\x00NtCommitTransaction\x00NtCompactKeys\x00NtCompareTokens\x00NtCompleteConnectPort\x00NtCompressKey\x00NtConnectPort\x00NtContinue\x00NtCreateDebugObject\x00NtCreateDirectoryObject\x00NtCreateEnlistment\x00NtCreateEvent\x00NtCreateEventPair\x00NtCreateFile\x00NtCreateIoCompletion\x00NtCreateJobObject\x00NtCreateJobSet\x00NtCreateKey\x00NtCreateKeyTransacted\x00NtCreateKeyedEvent\x00NtCreateMailslotFile\x00NtCreateMutant\x00NtCreateNamedPipeFile\x00NtCreatePagingFile\x00NtCreatePort\x00NtCreatePrivateNamespace\x00NtCreateProcess\x00NtCreateProcessEx\x00NtCreateProfile\x00NtCreateProfileEx\x00NtCreateResourceManager\x00NtCreateSection\x00NtCreateSemaphore\x00NtCreateSymbolicLinkObject\x00NtCreateThread\x00NtCreateThreadEx\x00NtCreateTimer\x00NtCreateToken\x00NtCreateTransaction\x00NtCreateTransactionManager\x00NtCreateUserProcess\x00NtCreateWaitablePort\x00NtCreateWorkerFactory\x00NtDebugActiveProcess\x00NtDebugContinue\x00NtDelayExecution\x00NtDeleteAtom\x00NtDeleteBootEntry\x00NtDeleteDriverEntry\x00NtDeleteFile\x00NtDeleteKey\x00NtDeleteObjectAuditAlarm\x00NtDeletePrivateNamespace\x00NtDeleteValueKey\x00NtDeviceIoControlFile\x00NtDisableLastKnownGood\x00NtDisplayString\x00NtDrawText\x00NtDuplicateObject\x00NtDuplicateToken\x00NtEnableLastKnownGood\x00NtEnumerateBootEntries\x00NtEnumerateDriverEntries\x00NtEnumerateKey\x00NtEnumerateSystemEnvironmentValuesEx\x00NtEnumerateTransactionObject\x00NtEnumerateValueKey\x00NtExtendSection\x00NtFilterToken\x00NtFindAtom\x00NtFlushBuffersFile\x00NtFlushInstallUILanguage\x00NtFlushInstructionCache\x00NtFlushKey\x00NtFlushProcessWriteBuffers\x00NtFlushVirtualMemory\x00NtFlushWriteBuffer\x00NtFreeUserPhysicalPages\x00NtFreeVirtualMemory\x00NtFreezeRegistry\x00NtFreezeTransactions\x00NtFsControlFile\x00NtGetContextThread\x00NtGetCurrentProcessorNumber\x00NtGetDevicePowerState\x00NtGetMUIRegistryInfo\x00NtGetNextProcess\x00NtGetNextThread\x00NtGetNlsSectionPtr\x00NtGetNotificationResourceManager\x00NtGetPlugPlayEvent\x00NtGetTickCount\x00NtGetWriteWatch\x00NtImpersonateAnonymousToken\x00NtImpersonateClientOfPort\x00NtImpersonateThread\x00NtInitializeNlsFiles\x00NtInitializeRegistry\x00NtInitiatePowerAction\x00NtIsProcessInJob\x00NtIsSystemResumeAutomatic\x00NtIsUILanguageComitted\x00NtListenPort\x00NtLoadDriver\x00NtLoadKey\x00NtLoadKey2\x00NtLoadKey3\x00NtLoadKeyEx\x00NtLockFile\x00NtLockProductActivationKeys\x00NtLockRegistryKey\x00NtLockVirtualMemory\x00NtMakePermanentObject\x00NtMakeTemporaryObject\x00NtMapCMFModule\x00NtMapUserPhysicalPages\x00NtMapUserPhysicalPagesScatter\x00NtMapViewOfSection\x00NtModifyBootEntry\x00NtModifyDriverEntry\x00NtNotifyChangeDirectoryFile\x00NtNotifyChangeKey\x00NtNotifyChangeMultipleKeys\x00NtNotifyChangeSession\x00NtOpenDirectoryObject\x00NtOpenEnlistment\x00NtOpenEvent\x00NtOpenEventPair\x00NtOpenFile\x00NtOpenIoCompletion\x00NtOpenJobObject\x00NtOpenKey\x00NtOpenKeyEx\x00NtOpenKeyTransacted\x00NtOpenKeyTransactedEx\x00NtOpenKeyedEvent\x00NtOpenMutant\x00NtOpenObjectAuditAlarm\x00NtOpenPrivateNamespace\x00NtOpenProcess\x00NtOpenProcessToken\x00NtOpenProcessTokenEx\x00NtOpenResourceManager\x00NtOpenSection\x00NtOpenSemaphore\x00NtOpenSession\x00NtOpenSymbolicLinkObject\x00NtOpenThread\x00NtOpenThreadToken\x00NtOpenThreadTokenEx\x00NtOpenTimer\x00NtOpenTransaction\x00NtOpenTransactionManager\x00NtPlugPlayControl\x00NtPowerInformation\x00NtPrePrepareComplete\x00NtPrePrepareEnlistment\x00NtPrepareComplete\x00NtPrepareEnlistment\x00NtPrivilegeCheck\x00NtPrivilegeObjectAuditAlarm\x00NtPrivilegedServiceAuditAlarm\x00NtPropagationComplete\x00NtPropagationFailed\x00NtProtectVirtualMemory\x00NtPulseEvent\x00NtQueryAttributesFile\x00NtQueryBootEntryOrder\x00NtQueryBootOptions\x00NtQueryDebugFilterState\x00NtQueryDefaultLocale\x00NtQueryDefaultUILanguage\x00NtQueryDirectoryFile\x00NtQueryDirectoryObject\x00NtQueryDriverEntryOrder\x00NtQueryEaFile\x00NtQueryEvent\x00NtQueryFullAttributesFile\x00NtQueryInformationAtom\x00NtQueryInformationEnlistment\x00NtQueryInformationFile\x00NtQueryInformationJobObject\x00NtQueryInformationPort\x00NtQueryInformationProcess\x00NtQueryInformationResourceManager\x00NtQueryInformationThread\x00NtQueryInformationToken\x00NtQueryInformationTransaction\x00NtQueryInformationTransactionManager\x00NtQueryInformationWorkerFactory\x00NtQueryInstallUILanguage\x00NtQueryIntervalProfile\x00NtQueryIoCompletion\x00NtQueryKey\x00NtQueryLicenseValue\x00NtQueryMultipleValueKey\x00NtQueryMutant\x00NtQueryObject\x00NtQueryOpenSubKeys\x00NtQueryOpenSubKeysEx\x00NtQueryPerformanceCounter\x00NtQueryPortInformationProcess\x00NtQueryQuotaInformationFile\x00NtQuerySection\x00NtQuerySecurityAttributesToken\x00NtQuerySecurityObject\x00NtQuerySemaphore\x00NtQuerySymbolicLinkObject\x00NtQuerySystemEnvironmentValue\x00NtQuerySystemEnvironmentValueEx\x00NtQuerySystemInformation\x00NtQuerySystemInformationEx\x00NtQuerySystemTime\x00NtQueryTimer\x00NtQueryTimerResolution\x00NtQueryValueKey\x00NtQueryVirtualMemory\x00NtQueryVolumeInformationFile\x00NtQueueApcThread\x00NtQueueApcThreadEx\x00NtRaiseException\x00NtRaiseHardError\x00NtReadFile\x00NtReadFileScatter\x00NtReadOnlyEnlistment\x00NtReadRequestData\x00NtReadVirtualMemory\x00NtRecoverEnlistment\x00NtRecoverResourceManager\x00NtRecoverTransactionManager\x00NtRegisterProtocolAddressInformation\x00NtRegisterThreadTerminatePort\x00NtReleaseKeyedEvent\x00NtReleaseMutant\x00NtReleaseSemaphore\x00NtReleaseWorkerFactoryWorker\x00NtRemoveIoCompletion\x00NtRemoveIoCompletionEx\x00NtRemoveProcessDebug\x00NtRenameKey\x00NtRenameTransactionManager\x00NtReplaceKey\x00NtReplacePartitionUnit\x00NtReplyPort\x00NtReplyWaitReceivePort\x00NtReplyWaitReceivePortEx\x00NtReplyWaitReplyPort\x00NtRequestPort\x00NtRequestWaitReplyPort\x00NtResetEvent\x00NtResetWriteWatch\x00NtRestoreKey\x00NtResumeProcess\x00NtResumeThread\x00NtRollbackComplete\x00NtRollbackEnlistment\x00NtRollbackTransaction\x00NtRollforwardTransactionManager\x00NtSaveKey\x00NtSaveKeyEx\x00NtSaveMergedKeys\x00NtSecureConnectPort\x00NtSerializeBoot\x00NtSetBootEntryOrder\x00NtSetBootOptions\x00NtSetContextThread\x00NtSetDebugFilterState\x00NtSetDefaultHardErrorPort\x00NtSetDefaultLocale\x00NtSetDefaultUILanguage\x00NtSetDriverEntryOrder\x00NtSetEaFile\x00NtSetEvent\x00NtSetEventBoostPriority\x00NtSetHighEventPair\x00NtSetHighWaitLowEventPair\x00NtSetInformationDebugObject\x00NtSetInformationEnlistment\x00NtSetInformationFile\x00NtSetInformationJobObject\x00NtSetInformationKey\x00NtSetInformationObject\x00NtSetInformationProcess\x00NtSetInformationResourceManager\x00NtSetInformationThread\x00NtSetInformationToken\x00NtSetInformationTransaction\x00NtSetInformationTransactionManager\x00NtSetInformationWorkerFactory\x00NtSetIntervalProfile\x00NtSetIoCompletion\x00NtSetIoCompletionEx\x00NtSetLdtEntries\x00NtSetLowEventPair\x00NtSetLowWaitHighEventPair\x00NtSetQuotaInformationFile\x00NtSetSecurityObject\x00NtSetSystemEnvironmentValue\x00NtSetSystemEnvironmentValueEx\x00NtSetSystemInformation\x00NtSetSystemPowerState\x00NtSetSystemTime\x00NtSetThreadExecutionState\x00NtSetTimer\x00NtSetTimerEx\x00NtSetTimerResolution\x00NtSetUuidSeed\x00NtSetValueKey\x00NtSetVolumeInformationFile\x00NtShutdownSystem\x00NtShutdownWorkerFactory\x00NtSignalAndWaitForSingleObject\x00NtSinglePhaseReject\x00NtStartProfile\x00NtStopProfile\x00NtSuspendProcess\x00NtSuspendThread\x00NtSystemDebugControl\x00NtTerminateJobObject\x00NtTerminateProcess\x00NtTerminateThread\x00NtTestAlert\x00NtThawRegistry\x00NtThawTransactions\x00NtTraceControl\x00NtTraceEvent\x00NtTranslateFilePath\x00NtUmsThreadYield\x00NtUnloadDriver\x00NtUnloadKey\x00NtUnloadKey2\x00NtUnloadKeyEx\x00NtUnlockFile\x00NtUnlockVirtualMemory\x00NtUnmapViewOfSection\x00NtVdmControl\x00NtWaitForDebugEvent\x00NtWaitForKeyedEvent\x00NtWaitForMultipleObjects\x00NtWaitForMultipleObjects32\x00NtWaitForSingleObject\x00NtWaitForWorkViaWorkerFactory\x00NtWaitHighEventPair\x00NtWaitLowEventPair\x00NtWorkerFactoryWorkerReady\x00NtWriteFile\x00NtWriteFileGather\x00NtWriteRequestData\x00NtWriteVirtualMemory\x00NtYieldExecution\x00NtdllDefWindowProc_A\x00NtdllDefWindowProc_W\x00NtdllDialogWndProc_A\x00NtdllDialogWndProc_W\x00PfxFindPrefix\x00PfxInitialize\x00PfxInsertPrefix\x00PfxRemovePrefix\x00RtlAbortRXact\x00RtlAbsoluteToSelfRelativeSD\x00RtlAcquirePebLock\x00RtlAcquirePrivilege\x00RtlAcquireReleaseSRWLockExclusive\x00RtlAcquireResourceExclusive\x00RtlAcquireResourceShared\x00RtlAcquireSRWLockExclusive\x00RtlAcquireSRWLockShared\x00RtlActivateActivationContext\x00RtlActivateActivationContextEx\x00RtlActivateActivationContextUnsafeFast\x00RtlAddAccessAllowedAce\x00RtlAddAccessAllowedAceEx\x00RtlAddAccessAllowedObjectAce\x00RtlAddAccessDeniedAce\x00RtlAddAccessDeniedAceEx\x00RtlAddAccessDeniedObjectAce\x00RtlAddAce\x00RtlAddActionToRXact\x00RtlAddAtomToAtomTable\x00RtlAddAttributeActionToRXact\x00RtlAddAuditAccessAce\x00RtlAddAuditAccessAceEx\x00RtlAddAuditAccessObjectAce\x00RtlAddCompoundAce\x00RtlAddFunctionTable\x00RtlAddIntegrityLabelToBoundaryDescriptor\x00RtlAddMandatoryAce\x00RtlAddRefActivationContext\x00RtlAddRefMemoryStream\x00RtlAddSIDToBoundaryDescriptor\x00RtlAddVectoredContinueHandler\x00RtlAddVectoredExceptionHandler\x00RtlAddressInSectionTable\x00RtlAdjustPrivilege\x00RtlAllocateActivationContextStack\x00RtlAllocateAndInitializeSid\x00RtlAllocateHandle\x00RtlAllocateHeap\x00RtlAllocateMemoryBlockLookaside\x00RtlAllocateMemoryZone\x00RtlAnsiCharToUnicodeChar\x00RtlAnsiStringToUnicodeSize\x00RtlAnsiStringToUnicodeString\x00RtlAppendAsciizToString\x00RtlAppendPathElement\x00RtlAppendStringToString\x00RtlAppendUnicodeStringToString\x00RtlAppendUnicodeToString\x00RtlApplicationVerifierStop\x00RtlApplyRXact\x00RtlApplyRXactNoFlush\x00RtlAreAllAccessesGranted\x00RtlAreAnyAccessesGranted\x00RtlAreBitsClear\x00RtlAreBitsSet\x00RtlAssert\x00RtlBarrier\x00RtlBarrierForDelete\x00RtlCancelTimer\x00RtlCaptureContext\x00RtlCaptureStackBackTrace\x00RtlCharToInteger\x00RtlCheckForOrphanedCriticalSections\x00RtlCheckRegistryKey\x00RtlCheckSandboxedToken\x00RtlCleanUpTEBLangLists\x00RtlClearAllBits\x00RtlClearBits\x00RtlCloneMemoryStream\x00RtlCloneUserProcess\x00RtlCmDecodeMemIoResource\x00RtlCmEncodeMemIoResource\x00RtlCommitDebugInfo\x00RtlCommitMemoryStream\x00RtlCompactHeap\x00RtlCompareAltitudes\x00RtlCompareMemory\x00RtlCompareMemoryUlong\x00RtlCompareString\x00RtlCompareUnicodeString\x00RtlCompareUnicodeStrings\x00RtlCompleteProcessCloning\x00RtlCompressBuffer\x00RtlComputeCrc32\x00RtlComputeImportTableHash\x00RtlComputePrivatizedDllName_U\x00RtlConnectToSm\x00RtlConsoleMultiByteToUnicodeN\x00RtlContractHashTable\x00RtlConvertExclusiveToShared\x00RtlConvertLCIDToString\x00RtlConvertSharedToExclusive\x00RtlConvertSidToUnicodeString\x00RtlConvertToAutoInheritSecurityObject\x00RtlConvertUiListToApiList\x00RtlCopyContext\x00RtlCopyExtendedContext\x00RtlCopyLuid\x00RtlCopyLuidAndAttributesArray\x00RtlCopyMappedMemory\x00RtlCopyMemory\x00RtlCopyMemoryNonTemporal\x00RtlCopyMemoryStreamTo\x00RtlCopyOutOfProcessMemoryStreamTo\x00RtlCopySecurityDescriptor\x00RtlCopySid\x00RtlCopySidAndAttributesArray\x00RtlCopyString\x00RtlCopyUnicodeString\x00RtlCreateAcl\x00RtlCreateActivationContext\x00RtlCreateAndSetSD\x00RtlCreateAtomTable\x00RtlCreateBootStatusDataFile\x00RtlCreateBoundaryDescriptor\x00RtlCreateEnvironment\x00RtlCreateEnvironmentEx\x00RtlCreateHashTable\x00RtlCreateHeap\x00RtlCreateMemoryBlockLookaside\x00RtlCreateMemoryZone\x00RtlCreateProcessParameters\x00RtlCreateProcessParametersEx\x00RtlCreateProcessReflection\x00RtlCreateQueryDebugBuffer\x00RtlCreateRegistryKey\x00RtlCreateSecurityDescriptor\x00RtlCreateServiceSid\x00RtlCreateSystemVolumeInformationFolder\x00RtlCreateTagHeap\x00RtlCreateTimer\x00RtlCreateTimerQueue\x00RtlCreateUmsCompletionList\x00RtlCreateUmsThread\x00RtlCreateUmsThreadContext\x00RtlCreateUnicodeString\x00RtlCreateUnicodeStringFromAsciiz\x00RtlCreateUserProcess\x00RtlCreateUserSecurityObject\x00RtlCreateUserStack\x00RtlCreateUserThread\x00RtlCreateVirtualAccountSid\x00RtlCultureNameToLCID\x00RtlCustomCPToUnicodeN\x00RtlCutoverTimeToSystemTime\x00RtlDeCommitDebugInfo\x00RtlDeNormalizeProcessParams\x00RtlDeactivateActivationContext\x00RtlDeactivateActivationContextUnsafeFast\x00RtlDebugPrintTimes\x00RtlDecodePointer\x00RtlDecodeSystemPointer\x00RtlDecompressBuffer\x00RtlDecompressFragment\x00RtlDefaultNpAcl\x00RtlDelete\x00RtlDeleteAce\x00RtlDeleteAtomFromAtomTable\x00RtlDeleteBarrier\x00RtlDeleteBoundaryDescriptor\x00RtlDeleteCriticalSection\x00RtlDeleteElementGenericTable\x00RtlDeleteElementGenericTableAvl\x00RtlDeleteFunctionTable\x00RtlDeleteHashTable\x00RtlDeleteNoSplay\x00RtlDeleteRegistryValue\x00RtlDeleteResource\x00RtlDeleteSecurityObject\x00RtlDeleteTimer\x00RtlDeleteTimerQueue\x00RtlDeleteTimerQueueEx\x00RtlDeleteUmsCompletionList\x00RtlDeleteUmsThreadContext\x00RtlDequeueUmsCompletionListItems\x00RtlDeregisterSecureMemoryCacheCallback\x00RtlDeregisterWait\x00RtlDeregisterWaitEx\x00RtlDestroyAtomTable\x00RtlDestroyEnvironment\x00RtlDestroyHandleTable\x00RtlDestroyHeap\x00RtlDestroyMemoryBlockLookaside\x00RtlDestroyMemoryZone\x00RtlDestroyProcessParameters\x00RtlDestroyQueryDebugBuffer\x00RtlDetectHeapLeaks\x00RtlDetermineDosPathNameType_U\x00RtlDisableThreadProfiling\x00RtlDllShutdownInProgress\x00RtlDnsHostNameToComputerName\x00RtlDoesFileExists_U\x00RtlDosApplyFileIsolationRedirection_Ustr\x00RtlDosPathNameToNtPathName_U\x00RtlDosPathNameToNtPathName_U_WithStatus\x00RtlDosPathNameToRelativeNtPathName_U\x00RtlDosPathNameToRelativeNtPathName_U_WithStatus\x00RtlDosSearchPath_U\x00RtlDosSearchPath_Ustr\x00RtlDowncaseUnicodeChar\x00RtlDowncaseUnicodeString\x00RtlDumpResource\x00RtlDuplicateUnicodeString\x00RtlEmptyAtomTable\x00RtlEnableEarlyCriticalSectionEventCreation\x00RtlEnableThreadProfiling\x00RtlEncodePointer\x00RtlEncodeSystemPointer\x00RtlEndEnumerationHashTable\x00RtlEndWeakEnumerationHashTable\x00RtlEnterCriticalSection\x00RtlEnterUmsSchedulingMode\x00RtlEnumProcessHeaps\x00RtlEnumerateEntryHashTable\x00RtlEnumerateGenericTable\x00RtlEnumerateGenericTableAvl\x00RtlEnumerateGenericTableLikeADirectory\x00RtlEnumerateGenericTableWithoutSplaying\x00RtlEnumerateGenericTableWithoutSplayingAvl\x00RtlEqualComputerName\x00RtlEqualDomainName\x00RtlEqualLuid\x00RtlEqualPrefixSid\x00RtlEqualSid\x00RtlEqualString\x00RtlEqualUnicodeString\x00RtlEraseUnicodeString\x00RtlEthernetAddressToStringA\x00RtlEthernetAddressToStringW\x00RtlEthernetStringToAddressA\x00RtlEthernetStringToAddressW\x00RtlExecuteUmsThread\x00RtlExitUserProcess\x00RtlExitUserThread\x00RtlExpandEnvironmentStrings\x00RtlExpandEnvironmentStrings_U\x00RtlExpandHashTable\x00RtlExtendMemoryBlockLookaside\x00RtlExtendMemoryZone\x00RtlFillMemory\x00RtlFinalReleaseOutOfProcessMemoryStream\x00RtlFindAceByType\x00RtlFindActivationContextSectionGuid\x00RtlFindActivationContextSectionString\x00RtlFindCharInUnicodeString\x00RtlFindClearBits\x00RtlFindClearBitsAndSet\x00RtlFindClearRuns\x00RtlFindClosestEncodableLength\x00RtlFindLastBackwardRunClear\x00RtlFindLeastSignificantBit\x00RtlFindLongestRunClear\x00RtlFindMessage\x00RtlFindMostSignificantBit\x00RtlFindNextForwardRunClear\x00RtlFindSetBits\x00RtlFindSetBitsAndClear\x00RtlFirstEntrySList\x00RtlFirstFreeAce\x00RtlFlsAlloc\x00RtlFlsFree\x00RtlFlushSecureMemoryCache\x00RtlFormatCurrentUserKeyPath\x00RtlFormatMessage\x00RtlFormatMessageEx\x00RtlFreeActivationContextStack\x00RtlFreeAnsiString\x00RtlFreeHandle\x00RtlFreeHeap\x00RtlFreeMemoryBlockLookaside\x00RtlFreeOemString\x00RtlFreeSid\x00RtlFreeThreadActivationContextStack\x00RtlFreeUnicodeString\x00RtlFreeUserStack\x00RtlGUIDFromString\x00RtlGenerate8dot3Name\x00RtlGetAce\x00RtlGetActiveActivationContext\x00RtlGetCallersAddress\x00RtlGetCompressionWorkSpaceSize\x00RtlGetControlSecurityDescriptor\x00RtlGetCriticalSectionRecursionCount\x00RtlGetCurrentDirectory_U\x00RtlGetCurrentPeb\x00RtlGetCurrentProcessorNumber\x00RtlGetCurrentProcessorNumberEx\x00RtlGetCurrentTransaction\x00RtlGetCurrentUmsThread\x00RtlGetDaclSecurityDescriptor\x00RtlGetElementGenericTable\x00RtlGetElementGenericTableAvl\x00RtlGetEnabledExtendedFeatures\x00RtlGetExtendedContextLength\x00RtlGetExtendedFeaturesMask\x00RtlGetFileMUIPath\x00RtlGetFrame\x00RtlGetFullPathName_U\x00RtlGetFullPathName_UEx\x00RtlGetFullPathName_UstrEx\x00RtlGetFunctionTableListHead\x00RtlGetGroupSecurityDescriptor\x00RtlGetIntegerAtom\x00RtlGetLastNtStatus\x00RtlGetLastWin32Error\x00RtlGetLengthWithoutLastFullDosOrNtPathElement\x00RtlGetLengthWithoutTrailingPathSeperators\x00RtlGetLocaleFileMappingAddress\x00RtlGetLongestNtPathLength\x00RtlGetNativeSystemInformation\x00RtlGetNextEntryHashTable\x00RtlGetNextUmsListItem\x00RtlGetNtGlobalFlags\x00RtlGetNtProductType\x00RtlGetNtVersionNumbers\x00RtlGetOwnerSecurityDescriptor\x00RtlGetParentLocaleName\x00RtlGetProcessHeaps\x00RtlGetProcessPreferredUILanguages\x00RtlGetProductInfo\x00RtlGetSaclSecurityDescriptor\x00RtlGetSecurityDescriptorRMControl\x00RtlGetSetBootStatusData\x00RtlGetSystemPreferredUILanguages\x00RtlGetThreadErrorMode\x00RtlGetThreadLangIdByIndex\x00RtlGetThreadPreferredUILanguages\x00RtlGetUILanguageInfo\x00RtlGetUmsCompletionListEvent\x00RtlGetUnloadEventTrace\x00RtlGetUnloadEventTraceEx\x00RtlGetUserInfoHeap\x00RtlGetUserPreferredUILanguages\x00RtlGetVersion\x00RtlHashUnicodeString\x00RtlHeapTrkInitialize\x00RtlIdentifierAuthoritySid\x00RtlIdnToAscii\x00RtlIdnToNameprepUnicode\x00RtlIdnToUnicode\x00RtlImageDirectoryEntryToData\x00RtlImageNtHeader\x00RtlImageNtHeaderEx\x00RtlImageRvaToSection\x00RtlImageRvaToVa\x00RtlImpersonateSelf\x00RtlImpersonateSelfEx\x00RtlInitAnsiString\x00RtlInitAnsiStringEx\x00RtlInitBarrier\x00RtlInitCodePageTable\x00RtlInitEnumerationHashTable\x00RtlInitMemoryStream\x00RtlInitNlsTables\x00RtlInitOutOfProcessMemoryStream\x00RtlInitString\x00RtlInitUnicodeString\x00RtlInitUnicodeStringEx\x00RtlInitWeakEnumerationHashTable\x00RtlInitializeAtomPackage\x00RtlInitializeBitMap\x00RtlInitializeConditionVariable\x00RtlInitializeContext\x00RtlInitializeCriticalSection\x00RtlInitializeCriticalSectionAndSpinCount\x00RtlInitializeCriticalSectionEx\x00RtlInitializeExtendedContext\x00RtlInitializeGenericTable\x00RtlInitializeGenericTableAvl\x00RtlInitializeHandleTable\x00RtlInitializeNtUserPfn\x00RtlInitializeRXact\x00RtlInitializeResource\x00RtlInitializeSListHead\x00RtlInitializeSRWLock\x00RtlInitializeSid\x00RtlInsertElementGenericTable\x00RtlInsertElementGenericTableAvl\x00RtlInsertElementGenericTableFull\x00RtlInsertElementGenericTableFullAvl\x00RtlInsertEntryHashTable\x00RtlInstallFunctionTableCallback\x00RtlInt64ToUnicodeString\x00RtlIntegerToChar\x00RtlIntegerToUnicodeString\x00RtlInterlockedClearBitRun\x00RtlInterlockedFlushSList\x00RtlInterlockedPopEntrySList\x00RtlInterlockedPushEntrySList\x00RtlInterlockedPushListSList\x00RtlInterlockedSetBitRun\x00RtlIoDecodeMemIoResource\x00RtlIoEncodeMemIoResource\x00RtlIpv4AddressToStringA\x00RtlIpv4AddressToStringExA\x00RtlIpv4AddressToStringExW\x00RtlIpv4AddressToStringW\x00RtlIpv4StringToAddressA\x00RtlIpv4StringToAddressExA\x00RtlIpv4StringToAddressExW\x00RtlIpv4StringToAddressW\x00RtlIpv6AddressToStringA\x00RtlIpv6AddressToStringExA\x00RtlIpv6AddressToStringExW\x00RtlIpv6AddressToStringW\x00RtlIpv6StringToAddressA\x00RtlIpv6StringToAddressExA\x00RtlIpv6StringToAddressExW\x00RtlIpv6StringToAddressW\x00RtlIsActivationContextActive\x00RtlIsCriticalSectionLocked\x00RtlIsCriticalSectionLockedByThread\x00RtlIsCurrentThreadAttachExempt\x00RtlIsDosDeviceName_U\x00RtlIsGenericTableEmpty\x00RtlIsGenericTableEmptyAvl\x00RtlIsNameInExpression\x00RtlIsNameLegalDOS8Dot3\x00RtlIsNormalizedString\x00RtlIsTextUnicode\x00RtlIsThreadWithinLoaderCallout\x00RtlIsValidHandle\x00RtlIsValidIndexHandle\x00RtlIsValidLocaleName\x00RtlKnownExceptionFilter\x00RtlLCIDToCultureName\x00RtlLargeIntegerToChar\x00RtlLcidToLocaleName\x00RtlLeaveCriticalSection\x00RtlLengthRequiredSid\x00RtlLengthSecurityDescriptor\x00RtlLengthSid\x00RtlLoadString\x00RtlLocalTimeToSystemTime\x00RtlLocaleNameToLcid\x00RtlLocateExtendedFeature\x00RtlLocateLegacyContext\x00RtlLockBootStatusData\x00RtlLockCurrentThread\x00RtlLockHeap\x00RtlLockMemoryBlockLookaside\x00RtlLockMemoryStreamRegion\x00RtlLockMemoryZone\x00RtlLockModuleSection\x00RtlLogStackBackTrace\x00RtlLookupAtomInAtomTable\x00RtlLookupElementGenericTable\x00RtlLookupElementGenericTableAvl\x00RtlLookupElementGenericTableFull\x00RtlLookupElementGenericTableFullAvl\x00RtlLookupEntryHashTable\x00RtlLookupFunctionEntry\x00RtlLookupFunctionTable\x00RtlMakeSelfRelativeSD\x00RtlMapGenericMask\x00RtlMapSecurityErrorToNtStatus\x00RtlMoveMemory\x00RtlMultiAppendUnicodeStringBuffer\x00RtlMultiByteToUnicodeN\x00RtlMultiByteToUnicodeSize\x00RtlMultipleAllocateHeap\x00RtlMultipleFreeHeap\x00RtlNewInstanceSecurityObject\x00RtlNewSecurityGrantedAccess\x00RtlNewSecurityObject\x00RtlNewSecurityObjectEx\x00RtlNewSecurityObjectWithMultipleInheritance\x00RtlNormalizeProcessParams\x00RtlNormalizeString\x00RtlNtPathNameToDosPathName\x00RtlNtStatusToDosError\x00RtlNtStatusToDosErrorNoTeb\x00RtlNtdllName\x00RtlNumberGenericTableElements\x00RtlNumberGenericTableElementsAvl\x00RtlNumberOfClearBits\x00RtlNumberOfSetBits\x00RtlNumberOfSetBitsUlongPtr\x00RtlOemStringToUnicodeSize\x00RtlOemStringToUnicodeString\x00RtlOemToUnicodeN\x00RtlOpenCurrentUser\x00RtlOwnerAcesPresent\x00RtlPcToFileHeader\x00RtlPinAtomInAtomTable\x00RtlPopFrame\x00RtlPrefixString\x00RtlPrefixUnicodeString\x00RtlPrepareForProcessCloning\x00RtlProcessFlsData\x00RtlProtectHeap\x00RtlPushFrame\x00RtlQueryActivationContextApplicationSettings\x00RtlQueryAtomInAtomTable\x00RtlQueryCriticalSectionOwner\x00RtlQueryDepthSList\x00RtlQueryDynamicTimeZoneInformation\x00RtlQueryElevationFlags\x00RtlQueryEnvironmentVariable\x00RtlQueryEnvironmentVariable_U\x00RtlQueryHeapInformation\x00RtlQueryInformationAcl\x00RtlQueryInformationActivationContext\x00RtlQueryInformationActiveActivationContext\x00RtlQueryInterfaceMemoryStream\x00RtlQueryModuleInformation\x00RtlQueryPerformanceCounter\x00RtlQueryPerformanceFrequency\x00RtlQueryProcessBackTraceInformation\x00RtlQueryProcessDebugInformation\x00RtlQueryProcessHeapInformation\x00RtlQueryProcessLockInformation\x00RtlQueryRegistryValues\x00RtlQuerySecurityObject\x00RtlQueryTagHeap\x00RtlQueryThreadProfiling\x00RtlQueryTimeZoneInformation\x00RtlQueryUmsThreadInformation\x00RtlQueueApcWow64Thread\x00RtlQueueWorkItem\x00RtlRaiseException\x00RtlRaiseStatus\x00RtlRandom\x00RtlRandomEx\x00RtlReAllocateHeap\x00RtlReadMemoryStream\x00RtlReadOutOfProcessMemoryStream\x00RtlReadThreadProfilingData\x00RtlRealPredecessor\x00RtlRealSuccessor\x00RtlRegisterSecureMemoryCacheCallback\x00RtlRegisterThreadWithCsrss\x00RtlRegisterWait\x00RtlReleaseActivationContext\x00RtlReleaseMemoryStream\x00RtlReleasePebLock\x00RtlReleasePrivilege\x00RtlReleaseRelativeName\x00RtlReleaseResource\x00RtlReleaseSRWLockExclusive\x00RtlReleaseSRWLockShared\x00RtlRemoteCall\x00RtlRemoveEntryHashTable\x00RtlRemovePrivileges\x00RtlRemoveVectoredContinueHandler\x00RtlRemoveVectoredExceptionHandler\x00RtlReplaceSidInSd\x00RtlReportException\x00RtlReportSilentProcessExit\x00RtlReportSqmEscalation\x00RtlResetMemoryBlockLookaside\x00RtlResetMemoryZone\x00RtlResetRtlTranslations\x00RtlRestoreContext\x00RtlRestoreLastWin32Error\x00RtlRetrieveNtUserPfn\x00RtlRevertMemoryStream\x00RtlRunDecodeUnicodeString\x00RtlRunEncodeUnicodeString\x00RtlRunOnceBeginInitialize\x00RtlRunOnceComplete\x00RtlRunOnceExecuteOnce\x00RtlRunOnceInitialize\x00RtlSecondsSince1970ToTime\x00RtlSecondsSince1980ToTime\x00RtlSeekMemoryStream\x00RtlSelfRelativeToAbsoluteSD\x00RtlSelfRelativeToAbsoluteSD2\x00RtlSendMsgToSm\x00RtlSetAllBits\x00RtlSetAttributesSecurityDescriptor\x00RtlSetBits\x00RtlSetControlSecurityDescriptor\x00RtlSetCriticalSectionSpinCount\x00RtlSetCurrentDirectory_U\x00RtlSetCurrentEnvironment\x00RtlSetCurrentTransaction\x00RtlSetDaclSecurityDescriptor\x00RtlSetDynamicTimeZoneInformation\x00RtlSetEnvironmentStrings\x00RtlSetEnvironmentVar\x00RtlSetEnvironmentVariable\x00RtlSetExtendedFeaturesMask\x00RtlSetGroupSecurityDescriptor\x00RtlSetHeapInformation\x00RtlSetInformationAcl\x00RtlSetIoCompletionCallback\x00RtlSetLastWin32Error\x00RtlSetLastWin32ErrorAndNtStatusFromNtStatus\x00RtlSetMemoryStreamSize\x00RtlSetOwnerSecurityDescriptor\x00RtlSetProcessDebugInformation\x00RtlSetProcessIsCritical\x00RtlSetProcessPreferredUILanguages\x00RtlSetSaclSecurityDescriptor\x00RtlSetSecurityDescriptorRMControl\x00RtlSetSecurityObject\x00RtlSetSecurityObjectEx\x00RtlSetThreadErrorMode\x00RtlSetThreadIsCritical\x00RtlSetThreadPoolStartFunc\x00RtlSetThreadPreferredUILanguages\x00RtlSetTimeZoneInformation\x00RtlSetTimer\x00RtlSetUmsThreadInformation\x00RtlSetUnhandledExceptionFilter\x00RtlSetUserFlagsHeap\x00RtlSetUserValueHeap\x00RtlSidDominates\x00RtlSidEqualLevel\x00RtlSidHashInitialize\x00RtlSidHashLookup\x00RtlSidIsHigherLevel\x00RtlSizeHeap\x00RtlSleepConditionVariableCS\x00RtlSleepConditionVariableSRW\x00RtlSplay\x00RtlStartRXact\x00RtlStatMemoryStream\x00RtlStringFromGUID\x00RtlSubAuthorityCountSid\x00RtlSubAuthoritySid\x00RtlSubtreePredecessor\x00RtlSubtreeSuccessor\x00RtlSystemTimeToLocalTime\x00RtlTestBit\x00RtlTimeFieldsToTime\x00RtlTimeToElapsedTimeFields\x00RtlTimeToSecondsSince1970\x00RtlTimeToSecondsSince1980\x00RtlTimeToTimeFields\x00RtlTraceDatabaseAdd\x00RtlTraceDatabaseCreate\x00RtlTraceDatabaseDestroy\x00RtlTraceDatabaseEnumerate\x00RtlTraceDatabaseFind\x00RtlTraceDatabaseLock\x00RtlTraceDatabaseUnlock\x00RtlTraceDatabaseValidate\x00RtlTryAcquirePebLock\x00RtlTryAcquireSRWLockExclusive\x00RtlTryAcquireSRWLockShared\x00RtlTryEnterCriticalSection\x00RtlUTF8ToUnicodeN\x00RtlUmsThreadYield\x00RtlUnhandledExceptionFilter\x00RtlUnhandledExceptionFilter2\x00RtlUnicodeStringToAnsiSize\x00RtlUnicodeStringToAnsiString\x00RtlUnicodeStringToCountedOemString\x00RtlUnicodeStringToInteger\x00RtlUnicodeStringToOemSize\x00RtlUnicodeStringToOemString\x00RtlUnicodeToCustomCPN\x00RtlUnicodeToMultiByteN\x00RtlUnicodeToMultiByteSize\x00RtlUnicodeToOemN\x00RtlUnicodeToUTF8N\x00RtlUniform\x00RtlUnlockBootStatusData\x00RtlUnlockCurrentThread\x00RtlUnlockHeap\x00RtlUnlockMemoryBlockLookaside\x00RtlUnlockMemoryStreamRegion\x00RtlUnlockMemoryZone\x00RtlUnlockModuleSection\x00RtlUnwind\x00RtlUnwindEx\x00RtlUpcaseUnicodeChar\x00RtlUpcaseUnicodeString\x00RtlUpcaseUnicodeStringToAnsiString\x00RtlUpcaseUnicodeStringToCountedOemString\x00RtlUpcaseUnicodeStringToOemString\x00RtlUpcaseUnicodeToCustomCPN\x00RtlUpcaseUnicodeToMultiByteN\x00RtlUpcaseUnicodeToOemN\x00RtlUpdateClonedCriticalSection\x00RtlUpdateClonedSRWLock\x00RtlUpdateTimer\x00RtlUpperChar\x00RtlUpperString\x00RtlUserThreadStart\x00RtlValidAcl\x00RtlValidRelativeSecurityDescriptor\x00RtlValidSecurityDescriptor\x00RtlValidSid\x00RtlValidateHeap\x00RtlValidateProcessHeaps\x00RtlValidateUnicodeString\x00RtlVerifyVersionInfo\x00RtlVirtualUnwind\x00RtlWakeAllConditionVariable\x00RtlWakeConditionVariable\x00RtlWalkFrameChain\x00RtlWalkHeap\x00RtlWeaklyEnumerateEntryHashTable\x00RtlWerpReportException\x00RtlWow64CallFunction64\x00RtlWow64EnableFsRedirection\x00RtlWow64EnableFsRedirectionEx\x00RtlWow64GetThreadContext\x00RtlWow64GetThreadSelectorEntry\x00RtlWow64LogMessageInEventLogger\x00RtlWow64SetThreadContext\x00RtlWow64SuspendThread\x00RtlWriteMemoryStream\x00RtlWriteRegistryValue\x00RtlZeroHeap\x00RtlZeroMemory\x00RtlZombifyActivationContext\x00RtlpApplyLengthFunction\x00RtlpCheckDynamicTimeZoneInformation\x00RtlpCleanupRegistryKeys\x00RtlpConvertCultureNamesToLCIDs\x00RtlpConvertLCIDsToCultureNames\x00RtlpCreateProcessRegistryInfo\x00RtlpEnsureBufferSize\x00RtlpExecuteUmsThread\x00RtlpGetLCIDFromLangInfoNode\x00RtlpGetNameFromLangInfoNode\x00RtlpGetSystemDefaultUILanguage\x00RtlpGetUserOrMachineUILanguage4NLS\x00RtlpInitializeLangRegistryInfo\x00RtlpIsQualifiedLanguage\x00RtlpLoadMachineUIByPolicy\x00RtlpLoadUserUIByPolicy\x00RtlpMuiFreeLangRegistryInfo\x00RtlpMuiRegCreateRegistryInfo\x00RtlpMuiRegFreeRegistryInfo\x00RtlpMuiRegLoadRegistryInfo\x00RtlpNotOwnerCriticalSection\x00RtlpNtCreateKey\x00RtlpNtEnumerateSubKey\x00RtlpNtMakeTemporaryKey\x00RtlpNtOpenKey\x00RtlpNtQueryValueKey\x00RtlpNtSetValueKey\x00RtlpQueryDefaultUILanguage\x00RtlpQueryProcessDebugInformationFromWow64\x00RtlpRefreshCachedUILanguage\x00RtlpSetInstallLanguage\x00RtlpSetPreferredUILanguages\x00RtlpSetUserPreferredUILanguages\x00RtlpUmsExecuteYieldThreadEnd\x00RtlpUmsThreadYield\x00RtlpUnWaitCriticalSection\x00RtlpVerifyAndCommitUILanguageSettings\x00RtlpWaitForCriticalSection\x00RtlxAnsiStringToUnicodeSize\x00RtlxOemStringToUnicodeSize\x00RtlxUnicodeStringToAnsiSize\x00RtlxUnicodeStringToOemSize\x00SbExecuteProcedure\x00SbSelectProcedure\x00ShipAssert\x00ShipAssertGetBufferInfo\x00ShipAssertMsgA\x00ShipAssertMsgW\x00TpAllocAlpcCompletion\x00TpAllocAlpcCompletionEx\x00TpAllocCleanupGroup\x00TpAllocIoCompletion\x00TpAllocPool\x00TpAllocTimer\x00TpAllocWait\x00TpAllocWork\x00TpAlpcRegisterCompletionList\x00TpAlpcUnregisterCompletionList\x00TpCallbackIndependent\x00TpCallbackLeaveCriticalSectionOnCompletion\x00TpCallbackMayRunLong\x00TpCallbackReleaseMutexOnCompletion\x00TpCallbackReleaseSemaphoreOnCompletion\x00TpCallbackSetEventOnCompletion\x00TpCallbackUnloadDllOnCompletion\x00TpCancelAsyncIoOperation\x00TpCaptureCaller\x00TpCheckTerminateWorker\x00TpDbgDumpHeapUsage\x00TpDbgSetLogRoutine\x00TpDisablePoolCallbackChecks\x00TpDisassociateCallback\x00TpIsTimerSet\x00TpPostWork\x00TpQueryPoolStackInformation\x00TpReleaseAlpcCompletion\x00TpReleaseCleanupGroup\x00TpReleaseCleanupGroupMembers\x00TpReleaseIoCompletion\x00TpReleasePool\x00TpReleaseTimer\x00TpReleaseWait\x00TpReleaseWork\x00TpSetDefaultPoolMaxThreads\x00TpSetDefaultPoolStackInformation\x00TpSetPoolMaxThreads\x00TpSetPoolMinThreads\x00TpSetPoolStackInformation\x00TpSetTimer\x00TpSetWait\x00TpSimpleTryPost\x00TpStartAsyncIoOperation\x00TpWaitForAlpcCompletion\x00TpWaitForIoCompletion\x00TpWaitForTimer\x00TpWaitForWait\x00TpWaitForWork\x00VerSetConditionMask\x00WerReportSQMEvent\x00WinSqmAddToAverageDWORD\x00WinSqmAddToStream\x00WinSqmAddToStreamEx\x00WinSqmCheckEscalationAddToStreamEx\x00WinSqmCheckEscalationSetDWORD\x00WinSqmCheckEscalationSetDWORD64\x00WinSqmCheckEscalationSetString\x00WinSqmCommonDatapointDelete\x00WinSqmCommonDatapointSetDWORD\x00WinSqmCommonDatapointSetDWORD64\x00WinSqmCommonDatapointSetStreamEx\x00WinSqmCommonDatapointSetString\x00WinSqmEndSession\x00WinSqmEventEnabled\x00WinSqmEventWrite\x00WinSqmGetEscalationRuleStatus\x00WinSqmGetInstrumentationProperty\x00WinSqmIncrementDWORD\x00WinSqmIsOptedIn\x00WinSqmIsOptedInEx\x00WinSqmSetDWORD\x00WinSqmSetDWORD64\x00WinSqmSetEscalationInfo\x00WinSqmSetIfMaxDWORD\x00WinSqmSetIfMinDWORD\x00WinSqmSetString\x00WinSqmStartSession\x00ZwAcceptConnectPort\x00ZwAccessCheck\x00ZwAccessCheckAndAuditAlarm\x00ZwAccessCheckByType\x00ZwAccessCheckByTypeAndAuditAlarm\x00ZwAccessCheckByTypeResultList\x00ZwAccessCheckByTypeResultListAndAuditAlarm\x00ZwAccessCheckByTypeResultListAndAuditAlarmByHandle\x00ZwAddAtom\x00ZwAddBootEntry\x00ZwAddDriverEntry\x00ZwAdjustGroupsToken\x00ZwAdjustPrivilegesToken\x00ZwAlertResumeThread\x00ZwAlertThread\x00ZwAllocateLocallyUniqueId\x00ZwAllocateReserveObject\x00ZwAllocateUserPhysicalPages\x00ZwAllocateUuids\x00ZwAllocateVirtualMemory\x00ZwAlpcAcceptConnectPort\x00ZwAlpcCancelMessage\x00ZwAlpcConnectPort\x00ZwAlpcCreatePort\x00ZwAlpcCreatePortSection\x00ZwAlpcCreateResourceReserve\x00ZwAlpcCreateSectionView\x00ZwAlpcCreateSecurityContext\x00ZwAlpcDeletePortSection\x00ZwAlpcDeleteResourceReserve\x00ZwAlpcDeleteSectionView\x00ZwAlpcDeleteSecurityContext\x00ZwAlpcDisconnectPort\x00ZwAlpcImpersonateClientOfPort\x00ZwAlpcOpenSenderProcess\x00ZwAlpcOpenSenderThread\x00ZwAlpcQueryInformation\x00ZwAlpcQueryInformationMessage\x00ZwAlpcRevokeSecurityContext\x00ZwAlpcSendWaitReceivePort\x00ZwAlpcSetInformation\x00ZwApphelpCacheControl\x00ZwAreMappedFilesTheSame\x00ZwAssignProcessToJobObject\x00ZwCallbackReturn\x00ZwCancelIoFile\x00ZwCancelIoFileEx\x00ZwCancelSynchronousIoFile\x00ZwCancelTimer\x00ZwClearEvent\x00ZwClose\x00ZwCloseObjectAuditAlarm\x00ZwCommitComplete\x00ZwCommitEnlistment\x00ZwCommitTransaction\x00ZwCompactKeys\x00ZwCompareTokens\x00ZwCompleteConnectPort\x00ZwCompressKey\x00ZwConnectPort\x00ZwContinue\x00ZwCreateDebugObject\x00ZwCreateDirectoryObject\x00ZwCreateEnlistment\x00ZwCreateEvent\x00ZwCreateEventPair\x00ZwCreateFile\x00ZwCreateIoCompletion\x00ZwCreateJobObject\x00ZwCreateJobSet\x00ZwCreateKey\x00ZwCreateKeyTransacted\x00ZwCreateKeyedEvent\x00ZwCreateMailslotFile\x00ZwCreateMutant\x00ZwCreateNamedPipeFile\x00ZwCreatePagingFile\x00ZwCreatePort\x00ZwCreatePrivateNamespace\x00ZwCreateProcess\x00ZwCreateProcessEx\x00ZwCreateProfile\x00ZwCreateProfileEx\x00ZwCreateResourceManager\x00ZwCreateSection\x00ZwCreateSemaphore\x00ZwCreateSymbolicLinkObject\x00ZwCreateThread\x00ZwCreateThreadEx\x00ZwCreateTimer\x00ZwCreateToken\x00ZwCreateTransaction\x00ZwCreateTransactionManager\x00ZwCreateUserProcess\x00ZwCreateWaitablePort\x00ZwCreateWorkerFactory\x00ZwDebugActiveProcess\x00ZwDebugContinue\x00ZwDelayExecution\x00ZwDeleteAtom\x00ZwDeleteBootEntry\x00ZwDeleteDriverEntry\x00ZwDeleteFile\x00ZwDeleteKey\x00ZwDeleteObjectAuditAlarm\x00ZwDeletePrivateNamespace\x00ZwDeleteValueKey\x00ZwDeviceIoControlFile\x00ZwDisableLastKnownGood\x00ZwDisplayString\x00ZwDrawText\x00ZwDuplicateObject\x00ZwDuplicateToken\x00ZwEnableLastKnownGood\x00ZwEnumerateBootEntries\x00ZwEnumerateDriverEntries\x00ZwEnumerateKey\x00ZwEnumerateSystemEnvironmentValuesEx\x00ZwEnumerateTransactionObject\x00ZwEnumerateValueKey\x00ZwExtendSection\x00ZwFilterToken\x00ZwFindAtom\x00ZwFlushBuffersFile\x00ZwFlushInstallUILanguage\x00ZwFlushInstructionCache\x00ZwFlushKey\x00ZwFlushProcessWriteBuffers\x00ZwFlushVirtualMemory\x00ZwFlushWriteBuffer\x00ZwFreeUserPhysicalPages\x00ZwFreeVirtualMemory\x00ZwFreezeRegistry\x00ZwFreezeTransactions\x00ZwFsControlFile\x00ZwGetContextThread\x00ZwGetCurrentProcessorNumber\x00ZwGetDevicePowerState\x00ZwGetMUIRegistryInfo\x00ZwGetNextProcess\x00ZwGetNextThread\x00ZwGetNlsSectionPtr\x00ZwGetNotificationResourceManager\x00ZwGetPlugPlayEvent\x00ZwGetWriteWatch\x00ZwImpersonateAnonymousToken\x00ZwImpersonateClientOfPort\x00ZwImpersonateThread\x00ZwInitializeNlsFiles\x00ZwInitializeRegistry\x00ZwInitiatePowerAction\x00ZwIsProcessInJob\x00ZwIsSystemResumeAutomatic\x00ZwIsUILanguageComitted\x00ZwListenPort\x00ZwLoadDriver\x00ZwLoadKey\x00ZwLoadKey2\x00ZwLoadKey3\x00ZwLoadKeyEx\x00ZwLockFile\x00ZwLockProductActivationKeys\x00ZwLockRegistryKey\x00ZwLockVirtualMemory\x00ZwMakePermanentObject\x00ZwMakeTemporaryObject\x00ZwMapCMFModule\x00ZwMapUserPhysicalPages\x00ZwMapUserPhysicalPagesScatter\x00ZwMapViewOfSection\x00ZwModifyBootEntry\x00ZwModifyDriverEntry\x00ZwNotifyChangeDirectoryFile\x00ZwNotifyChangeKey\x00ZwNotifyChangeMultipleKeys\x00ZwNotifyChangeSession\x00ZwOpenDirectoryObject\x00ZwOpenEnlistment\x00ZwOpenEvent\x00ZwOpenEventPair\x00ZwOpenFile\x00ZwOpenIoCompletion\x00ZwOpenJobObject\x00ZwOpenKey\x00ZwOpenKeyEx\x00ZwOpenKeyTransacted\x00ZwOpenKeyTransactedEx\x00ZwOpenKeyedEvent\x00ZwOpenMutant\x00ZwOpenObjectAuditAlarm\x00ZwOpenPrivateNamespace\x00ZwOpenProcess\x00ZwOpenProcessToken\x00ZwOpenProcessTokenEx\x00ZwOpenResourceManager\x00ZwOpenSection\x00ZwOpenSemaphore\x00ZwOpenSession\x00ZwOpenSymbolicLinkObject\x00ZwOpenThread\x00ZwOpenThreadToken\x00ZwOpenThreadTokenEx\x00ZwOpenTimer\x00ZwOpenTransaction\x00ZwOpenTransactionManager\x00ZwPlugPlayControl\x00ZwPowerInformation\x00ZwPrePrepareComplete\x00ZwPrePrepareEnlistment\x00ZwPrepareComplete\x00ZwPrepareEnlistment\x00ZwPrivilegeCheck\x00ZwPrivilegeObjectAuditAlarm\x00ZwPrivilegedServiceAuditAlarm\x00ZwPropagationComplete\x00ZwPropagationFailed\x00ZwProtectVirtualMemory\x00ZwPulseEvent\x00ZwQueryAttributesFile\x00ZwQueryBootEntryOrder\x00ZwQueryBootOptions\x00ZwQueryDebugFilterState\x00ZwQueryDefaultLocale\x00ZwQueryDefaultUILanguage\x00ZwQueryDirectoryFile\x00ZwQueryDirectoryObject\x00ZwQueryDriverEntryOrder\x00ZwQueryEaFile\x00ZwQueryEvent\x00ZwQueryFullAttributesFile\x00ZwQueryInformationAtom\x00ZwQueryInformationEnlistment\x00ZwQueryInformationFile\x00ZwQueryInformationJobObject\x00ZwQueryInformationPort\x00ZwQueryInformationProcess\x00ZwQueryInformationResourceManager\x00ZwQueryInformationThread\x00ZwQueryInformationToken\x00ZwQueryInformationTransaction\x00ZwQueryInformationTransactionManager\x00ZwQueryInformationWorkerFactory\x00ZwQueryInstallUILanguage\x00ZwQueryIntervalProfile\x00ZwQueryIoCompletion\x00ZwQueryKey\x00ZwQueryLicenseValue\x00ZwQueryMultipleValueKey\x00ZwQueryMutant\x00ZwQueryObject\x00ZwQueryOpenSubKeys\x00ZwQueryOpenSubKeysEx\x00ZwQueryPerformanceCounter\x00ZwQueryPortInformationProcess\x00ZwQueryQuotaInformationFile\x00ZwQuerySection\x00ZwQuerySecurityAttributesToken\x00ZwQuerySecurityObject\x00ZwQuerySemaphore\x00ZwQuerySymbolicLinkObject\x00ZwQuerySystemEnvironmentValue\x00ZwQuerySystemEnvironmentValueEx\x00ZwQuerySystemInformation\x00ZwQuerySystemInformationEx\x00ZwQuerySystemTime\x00ZwQueryTimer\x00ZwQueryTimerResolution\x00ZwQueryValueKey\x00ZwQueryVirtualMemory\x00ZwQueryVolumeInformationFile\x00ZwQueueApcThread\x00ZwQueueApcThreadEx\x00ZwRaiseException\x00ZwRaiseHardError\x00ZwReadFile\x00ZwReadFileScatter\x00ZwReadOnlyEnlistment\x00ZwReadRequestData\x00ZwReadVirtualMemory\x00ZwRecoverEnlistment\x00ZwRecoverResourceManager\x00ZwRecoverTransactionManager\x00ZwRegisterProtocolAddressInformation\x00ZwRegisterThreadTerminatePort\x00ZwReleaseKeyedEvent\x00ZwReleaseMutant\x00ZwReleaseSemaphore\x00ZwReleaseWorkerFactoryWorker\x00ZwRemoveIoCompletion\x00ZwRemoveIoCompletionEx\x00ZwRemoveProcessDebug\x00ZwRenameKey\x00ZwRenameTransactionManager\x00ZwReplaceKey\x00ZwReplacePartitionUnit\x00ZwReplyPort\x00ZwReplyWaitReceivePort\x00ZwReplyWaitReceivePortEx\x00ZwReplyWaitReplyPort\x00ZwRequestPort\x00ZwRequestWaitReplyPort\x00ZwResetEvent\x00ZwResetWriteWatch\x00ZwRestoreKey\x00ZwResumeProcess\x00ZwResumeThread\x00ZwRollbackComplete\x00ZwRollbackEnlistment\x00ZwRollbackTransaction\x00ZwRollforwardTransactionManager\x00ZwSaveKey\x00ZwSaveKeyEx\x00ZwSaveMergedKeys\x00ZwSecureConnectPort\x00ZwSerializeBoot\x00ZwSetBootEntryOrder\x00ZwSetBootOptions\x00ZwSetContextThread\x00ZwSetDebugFilterState\x00ZwSetDefaultHardErrorPort\x00ZwSetDefaultLocale\x00ZwSetDefaultUILanguage\x00ZwSetDriverEntryOrder\x00ZwSetEaFile\x00ZwSetEvent\x00ZwSetEventBoostPriority\x00ZwSetHighEventPair\x00ZwSetHighWaitLowEventPair\x00ZwSetInformationDebugObject\x00ZwSetInformationEnlistment\x00ZwSetInformationFile\x00ZwSetInformationJobObject\x00ZwSetInformationKey\x00ZwSetInformationObject\x00ZwSetInformationProcess\x00ZwSetInformationResourceManager\x00ZwSetInformationThread\x00ZwSetInformationToken\x00ZwSetInformationTransaction\x00ZwSetInformationTransactionManager\x00ZwSetInformationWorkerFactory\x00ZwSetIntervalProfile\x00ZwSetIoCompletion\x00ZwSetIoCompletionEx\x00ZwSetLdtEntries\x00ZwSetLowEventPair\x00ZwSetLowWaitHighEventPair\x00ZwSetQuotaInformationFile\x00ZwSetSecurityObject\x00ZwSetSystemEnvironmentValue\x00ZwSetSystemEnvironmentValueEx\x00ZwSetSystemInformation\x00ZwSetSystemPowerState\x00ZwSetSystemTime\x00ZwSetThreadExecutionState\x00ZwSetTimer\x00ZwSetTimerEx\x00ZwSetTimerResolution\x00ZwSetUuidSeed\x00ZwSetValueKey\x00ZwSetVolumeInformationFile\x00ZwShutdownSystem\x00ZwShutdownWorkerFactory\x00ZwSignalAndWaitForSingleObject\x00ZwSinglePhaseReject\x00ZwStartProfile\x00ZwStopProfile\x00ZwSuspendProcess\x00ZwSuspendThread\x00ZwSystemDebugControl\x00ZwTerminateJobObject\x00ZwTerminateProcess\x00ZwTerminateThread\x00ZwTestAlert\x00ZwThawRegistry\x00ZwThawTransactions\x00ZwTraceControl\x00ZwTraceEvent\x00ZwTranslateFilePath\x00ZwUmsThreadYield\x00ZwUnloadDriver\x00ZwUnloadKey\x00ZwUnloadKey2\x00ZwUnloadKeyEx\x00ZwUnlockFile\x00ZwUnlockVirtualMemory\x00ZwUnmapViewOfSection\x00ZwVdmControl\x00ZwWaitForDebugEvent\x00ZwWaitForKeyedEvent\x00ZwWaitForMultipleObjects\x00ZwWaitForMultipleObjects32\x00ZwWaitForSingleObject\x00ZwWaitForWorkViaWorkerFactory\x00ZwWaitHighEventPair\x00ZwWaitLowEventPair\x00ZwWorkerFactoryWorkerReady\x00ZwWriteFile\x00ZwWriteFileGather\x00ZwWriteRequestData\x00ZwWriteVirtualMemory\x00ZwYieldExecution\x00__C_specific_handler\x00__chkstk\x00__isascii\x00__iscsym\x00__iscsymf\x00__misaligned_access\x00__toascii\x00_atoi64\x00_fltused\x00_i64toa\x00_i64toa_s\x00_i64tow\x00_i64tow_s\x00_itoa\x00_itoa_s\x00_itow\x00_itow_s\x00_lfind\x00_local_unwind\x00_ltoa\x00_ltoa_s\x00_ltow\x00_ltow_s\x00_makepath_s\x00_memccpy\x00_memicmp\x00_setjmp\x00_setjmpex\x00_snprintf\x00_snprintf_s\x00_snscanf_s\x00_snwprintf\x00_snwprintf_s\x00_snwscanf_s\x00_splitpath\x00_splitpath_s\x00_strcmpi\x00_stricmp\x00_strlwr\x00_strnicmp\x00_strnset_s\x00_strset_s\x00_strupr\x00_swprintf\x00_ui64toa\x00_ui64toa_s\x00_ui64tow\x00_ui64tow_s\x00_ultoa\x00_ultoa_s\x00_ultow\x00_ultow_s\x00_vscwprintf\x00_vsnprintf\x00_vsnprintf_s\x00_vsnwprintf\x00_vsnwprintf_s\x00_vswprintf\x00_wcsicmp\x00_wcslwr\x00_wcsnicmp\x00_wcsnset_s\x00_wcsset_s\x00_wcstoui64\x00_wcsupr\x00_wmakepath_s\x00_wsplitpath_s\x00_wtoi\x00_wtoi64\x00_wtol\x00abs\x00atan\x00atoi\x00atol\x00bsearch\x00ceil\x00cos\x00fabs\x00floor\x00isalnum\x00isalpha\x00iscntrl\x00isdigit\x00isgraph\x00islower\x00isprint\x00ispunct\x00isspace\x00isupper\x00iswalpha\x00iswctype\x00iswdigit\x00iswlower\x00iswspace\x00iswxdigit\x00isxdigit\x00labs\x00log\x00longjmp\x00mbstowcs\x00memchr\x00memcmp\x00memcpy\x00memcpy_s\x00memmove\x00memmove_s\x00memset\x00pow\x00qsort\x00sin\x00sprintf\x00sprintf_s\x00sqrt\x00sscanf\x00sscanf_s\x00strcat\x00strcat_s\x00strchr\x00strcmp\x00strcpy\x00strcpy_s\x00strcspn\x00strlen\x00strncat\x00strncat_s\x00strncmp\x00strncpy\x00strncpy_s\x00strnlen\x00strpbrk\x00strrchr\x00strspn\x00strstr\x00strtok_s\x00strtol\x00strtoul\x00swprintf\x00swprintf_s\x00swscanf_s\x00tan\x00tolower\x00toupper\x00towlower\x00towupper\x00vDbgPrintEx\x00vDbgPrintExWithPrefix\x00vsprintf\x00vsprintf_s\x00vswprintf_s\x00wcscat\x00wcscat_s\x00wcschr\x00wcscmp\x00wcscpy\x00wcscpy_s\x00wcscspn\x00wcslen\x00wcsncat\x00wcsncat_s\x00wcsncmp\x00wcsncpy\x00wcsncpy_s\x00wcsnlen\x00wcspbrk\x00wcsrchr\x00wcsspn\x00wcsstr\x00wcstol\x00wcstombs\x00wcstoul"
                        for i in raw_string:
                            for j in i:
                                if j == "\x00":
                                    neprocesat.append(currnt_str)
                                    currnt_str = ""
                                else:
                                    currnt_str += j
                        ebx = 0
                        external_cnt = 0
                        external_solution = ""
                        while(True):
                            string = neprocesat[ebx]
                            rcx = string
                            v14 = some_hash_0x1003F(rcx)
                            if(v14 == a2): #teoria si practica din debugger zice ca v14 = 0x76 iterari ca sa fie acelasi hash
                                #pass
                                external_cnt = ebx
                                external_solution = string
                                print(hex(ebx)) 
                                print(string)
                                break
                            if( (ebx+1) >= temp):
                                break
                                #aici implementat label 15
                            ebx += 1

                        v12 = alphabet 
                        ecx = int.from_bytes(rsi[0x1c:(0x1c+4)],"little")
                        print(hex(ecx))
                        rcx = binar[ecx:]
                        #here we do artificially external_cnt 75 just for test purpose
                        edx = alphabet[external_cnt*2]
                        print(hex(edx))
                        ebx = int.from_bytes(rcx[edx*4:edx*4+4],"little")
                        rbx = binar[ebx:ebx+4]
                        print(hexdump(rbx))
                        
                        if(int.from_bytes(rbx) == 0 ):
                            return 0
                        else:
                            if(int.from_bytes(rbx) > int.from_bytes(rsi[0:4])):
                                print("====================================================") 
                                print(external_solution)
                            else:
                                pass
                    
                    else:
                        """
                        still idk whhat to implement here :(
                        """
                        pass
                else:
                    pass


def my_wcsncat(a,b,c):
    """
    b = source in our case c:\\windows\\system32\ntdll.dll
    a = destination in our case buffer(\\??\\)+b
    c = size de concatenat
    alltough this algorithm seems to support unicode fuck unicode :)
    we do it normally as normal human beings :)
    """
    rax = c-1
    r11 = b
    r9 = c
    rbx = a
    if(rax > 0x7FFFFFFE):
        return 0x80070057
    else:
        r10 = c
        rax = a
        edi = 0
        ctr = 0
        if(len(rax) == edi):
            return 
        else:
            while(rax):
                if(rax == "00"):#or (rax == "00" and a[ctr+2:ctr+4] and a[ctr+6:ctr+8]))):
                    break
                rax = a[ctr:ctr+2]
                #print(hex(r10))
                ctr += 1
                print(hex(r10))
                r10 -=1
            rax = r10-1
            rcx = c
            rax = ~rax 
            print(hex(rax& 0xffffffff))
            rax = r10

def replace_str_index(text,index=0,replacement=''):
    return f'{text[:index]}{replacement}{text[index+1:]}'

def sub_13FDE67D4(a,b,c,binar):
    """
    goal return \\??\\ as string
    """
    v5 = 0 
    #print(a)
    if(b > 2):
        if(c):
            dword_13FE5FA24 = 0
            dword_13FE5FA28 = [None for i in range(0x7D0)]
            dword_13FE5FA20 = [None for i in range(0x10)]

        ecx = dword_13FE5FA24
        v6 = b - 1
        edx = a[v6*2]
        #print(hexdump(a))
        #print(hex(edx))
        v8 = 0
        edx = int(edx) - 0x60
        eax = -1
        r11 = dword_13FE5FA20[1]
        #print("aicia")
        #print(hex(edx))
        #print(hex(a[v6*2]))
        if(int(a[v6*2]) <= 0x7F):
            edx = a[v6*2]
        #print(hex(edx))
        eax += b
        dword_13FE5FA20[((eax*2+8)//4)+1] = hex(edx)
        cnt_extern = b
        rax_temp = 0
        while ( v8 < b ):
            #print(v8,b)
            edx = dword_13FE5FA24
            eax = b
            eax -= v8
            edx -= v8
            eax -=1
            edx += b
            #print(eax,int(math.floor((eax*2+8)/4)))
            ecx = a[eax*2]
            #print(hex(ecx))
            #eax = b-1
            #print("aicia2")
            xor_operand = int(str(dword_13FE5FA20[b-v8]),base=16)
            #print("xor_operand")
            #print(hex(xor_operand))
            r8d =( ecx - 0x60 )
            if(r8d < 0):
                #print("aicia3")
                r8d =( ecx - 0x60 )  & 0xffffffff
                #print(hex(r8d))
                r8d = hex(r8d)[2:6]+"0000"
                r8d = int(r8d,base=16)

            if(r8d ^ xor_operand == 0):
            #print(eax,int(math.floor((eax*2+8)/4)))
                dword_13FE5FA20[b-v8-1] = hex(xor_operand)
            else:
                if(len(hex(r8d ^ xor_operand)) > 4):
                    dword_13FE5FA20[b-v8-1] = "0x"+hex(r8d ^ xor_operand)[-2:]
                    """
                    current bug
                    din 0xffffffa0 -> paddui manual in ffff0000 e bun pt prim caz da al 2
                    a 2 iteratie ar trebui sa fie 0xffffffac->00000000FFFF000C
                    """
                else:
                    dword_13FE5FA20[b-v8-1] = hex(r8d ^ xor_operand)
            #print("r8d operand")
            #print(hex(r8d))
            #print(r8d)
            #print(dword_13FE5FA20)
            v8 += 1
        dword_13FE5FA20 = dword_13FE5FA20[0:5]
        print(dword_13FE5FA20)
        
        v12 = 0 
        if(b != 1):
            while(v12 < v6):
                eax = dword_13FE5FA24+v12
                edx = eax
                print(eax,edx)
                r8d = dword_13FE5FA20[v12]
                print(r8d)
                eax +=1
                eax = dword_13FE5FA20[eax]
                dword_13FE5FA20[edx] = eax
                ecx = v12+1
                dword_13FE5FA20[ecx] = r8d
                #print(dword_13FE5FA20)
                v12 += 2
        print(dword_13FE5FA20)

        r10 = 0
        for i in range(2):
            ecx = dword_13FE5FA24
            eax = ecx+r10
            ecx -= r10
            r8d = dword_13FE5FA20[eax]
            edx = eax
            #print(edx)
            eax = b-1
            eax += ecx
            eax = dword_13FE5FA20[eax]
            dword_13FE5FA20[edx] = eax
            eax = dword_13FE5FA24
            eax -= r10
            r10 += 1
            eax -= 1
            eax +=b
            #print(eax)
            dword_13FE5FA20[eax] = r8d

        print(dword_13FE5FA20)
        edx = dword_13FE5FA24
        dword_13FE5FA20[4] = 0x00
        dword_13FE5FA20.insert(0,b)
        print(dword_13FE5FA20)
        s = ""
        for i in range(1,len(dword_13FE5FA20)):
            s += chr(int(str(dword_13FE5FA20[i]),base=16))
        return s

def get_ntdll_and_unhook2(x):
    """
    None of the less the function starts like this 
      if ( ntquertyinformationprocess_anti_debug() )// anti_debug
                                                // 
                                                // 
    MEMORY[0] = 0x4E8C;
    but we skip cause oh well dast is nice and it renders this anti debug usless
    :)
    """
    v2 = iterate_over_module_name_and_hash(x)
    v3 = v2
    if(v2 and v3):    
        binar = open(sys.argv[1],"rb").read()
        mz_header = binar[0:2]
        if(mz_header == b'MZ'):
            mz_header_binary = binar
            print("aici")
            pe_heder =  binar[binar[0x3c]:]
            if(pe_heder):
                rcx = [
                    0x0C, 0x00, 0xCF, 0x00, 0x00, 0x00, 0xC3, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0xC2, 0x00, 0x9D, 0x00, 0xBE, 0x00, 0xA7, 0x00, 0x11, 0x00, 0x1C, 0x00, 0x0A, 0x00, 0x00, 0x00,
                    0xD3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x84, 0x00, 0x07, 0x00, 0x16, 0x00,
                    0x06, 0x00, 0x01, 0x00, 0x08, 0x00, 0x0E, 0x00, 0x8B, 0x00, 0x82, 0x00, 0x08, 0x00, 0x8B, 0x00,
                    0x8F, 0x00, 0x12, 0x00, 0x16, 0x00, 0x87, 0x00, 0x83, 0x00, 0x9D, 0x00, 0xBC, 0x00, 0x00, 0x00,
                    0x9C, 0x00, 0x94, 0x00, 0x08, 0x00, 0x01, 0x00, 0xA3, 0x00, 0xAF, 0x00, 0x05, 0x00, 0x14, 0x00,
                    0x13, 0x00, 0x9F, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x85, 0xC8, 0xA8, 0x18, 0x85, 0x06, 0x19, 0x15,
                    0x8D, 0x88, 0x87, 0x09, 0x18, 0x90, 0xD7, 0x7F, 0x83, 0xBA, 0xBA, 0x99, 0x1E, 0x09, 0xD8, 0xCD,
                    0x85, 0x17, 0xBF, 0xB5, 0x95, 0x81, 0x1C, 0x0D, 0xC9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0x84, 0x00, 0x95, 0x00, 0x0B, 0x00, 0x00, 0x00, 0x03, 0x00, 0x1F, 0x00, 0x1D, 0x00, 0x19, 0x00,
                    0x1F, 0x00, 0x8C, 0x00, 0x8B, 0x00, 0x92, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0xC0, 0x00, 0xC1, 0x00, 0x1F, 0x00, 0xAB, 0x00, 0xAA, 0x00, 0xBF, 0x00, 0x1C, 0x00, 0x0D, 0x00,
                    0x0C, 0x00, 0x88, 0x00, 0x9D, 0x00, 0x88, 0x00, 0xD0, 0x00, 0xD4, 0x00, 0x00, 0x00, 0x9A, 0x00,
                    0x86, 0x00, 0x1F, 0x00, 0x9E, 0x00, 0xC9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0x9D, 0x00, 0x93, 0x00, 0x0C, 0x00, 0x06, 0x00, 0xA7, 0x00, 0xAD, 0x00, 0x10, 0x00, 0x07, 0x00,
                    0x1A, 0x00, 0x1D, 0x00, 0x15, 0x00, 0xA8, 0x00, 0xA3, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0xD7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x84, 0x00, 0x84, 0x00, 0x0C, 0x00, 0x11, 0x00,
                    0xA7, 0x00, 0xAD, 0x00, 0x10, 0x00, 0xBC, 0x00, 0xA1, 0x00, 0xCE, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0x04, 0x00, 0x17, 0x00, 0x02, 0x00, 0xA5, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0x9D, 0x00, 0x84, 0x00, 0x11, 0x00, 0x1C, 0x00, 0x0A, 0x00, 0x80, 0x00, 0xB3, 0x00, 0x00, 0x00,
                    0xC0, 0x00, 0xC7, 0x00, 0x00, 0x00, 0x04, 0x00, 0x01, 0x00, 0x11, 0x00, 0x83, 0x00, 0x00, 0x00,
                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xDE, 0x00, 0x87, 0x00, 0x19, 0x00, 0x0A, 0x00,
                    0x0B, 0x00, 0x1A, 0x00, 0x01, 0x00, 0x07, 0x00, 0x1B, 0x00, 0x1C, 0x00, 0xB4, 0x00, 0xAE, 0x00,
                    0x01, 0x00, 0x00, 0x00, 0xAF, 0x00, 0x00, 0x00, 0xC4, 0x00, 0x97, 0x00, 0xBD, 0x00, 0xAB, 0x00,
                    0x16, 0x00, 0x14, 0x00, 0x15, 0x00, 0x00, 0x00, 0x1D, 0x00, 0xAF, 0x00, 0xB0, 0x00, 0x19, 0x00,
                    0x07, 0x00, 0x0B, 0x00, 0xA5, 0x00, 0xA1, 0x00, 0x15, 0x00, 0x04, 0x00, 0x14, 0x00, 0x91, 0x00,
                    0xB5, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xD9, 0x00, 0x12, 0x00, 0x03, 0x00, 0xDA, 0x00,
                    0x00, 0x00, 0xDA, 0x00, 0xDA, 0x00, 0x00, 0x00, 0xD0, 0x00, 0x08, 0x00, 0x0A, 0x00, 0x06, 0x00,
                    0x06, 0x00, 0x08, 0x00, 0xDA, 0x00, 0x12, 0x00, 0x01, 0x00, 0xC9, 0x00, 0x14, 0x00, 0xCE, 0x00,
                    0x00, 0x00, 0xCC, 0x00, 0xCC, 0x00, 0xC9, 0x00, 0x19, 0x00, 0xD0, 0x00, 0xD0, 0x00, 0x08, 0x00,
                    0x0A, 0x00, 0x06, 0x00, 0x06, 0x00, 0x08, 0x00, 0xDA, 0x00, 0x12, 0x00, 0x01, 0x00, 0xC9, 0x00,
                    0x0F, 0x00, 0xD5, 0x00, 0x00, 0x00, 0xDA, 0x00, 0xDA, 0x00, 0x00, 0x00, 0xD0, 0x00, 0x08, 0x00,
                    0x0A, 0x00, 0x06, 0x00, 0x06, 0x00, 0x0D, 0x00, 0x7F, 0x00, 0x12, 0x00, 0x01, 0x00, 0xCA, 0x00,
                    0x05, 0x00, 0xDC, 0x00, 0x00, 0x00, 0xDA, 0x00, 0xDA, 0x00, 0x00, 0x00, 0xD0, 0x00, 0x08, 0x00,
                    0x0A, 0x00, 0x06, 0x00, 0x06, 0x00, 0x0D, 0x00, 0x7F, 0x00, 0x01, 0x00, 0x12, 0x00, 0xCC, 0x00,
                    0xA4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x93, 0x00, 0x06, 0x00, 0x13, 0x00,
                    0x1F, 0x00, 0x8D, 0x00, 0x81, 0x00, 0x99, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x94, 0x00, 0x17, 0x00, 0x12, 0x00,
                    0x13, 0x00, 0x19, 0x00, 0x88, 0x00, 0x8C, 0x00, 0x1D, 0x00, 0x06, 0x00, 0x03, 0x00, 0x99, 0x00,
                    0x8B, 0x00, 0x0B, 0x00, 0x92, 0x00, 0x95, 0x00, 0x06, 0x00, 0x1D, 0x00, 0x01, 0x00, 0x85, 0x00,
                    0x93, 0x00, 0x0B, 0x00, 0x1A, 0x00, 0x06, 0x00, 0x17, 0x00, 0x10, 0x00, 0x07, 0x00, 0x8E, 0x00,
                    0x1F, 0x00, 0x0D, 0x00, 0x1A, 0x00, 0x87, 0x00, 0xB3, 0x00, 0xAF, 0x00, 0x18, 0x00, 0x19, 0x00,
                    0x0A, 0x00, 0x93, 0x00, 0x9E, 0x00, 0x1D, 0x00, 0x88, 0x00, 0x93, 0x00, 0x09, 0x00, 0x09, 0x00,
                    0x1C, 0x00, 0x10, 0x00, 0x11, 0x00, 0x9F, 0x00, 0x84, 0x00, 0x0C, 0x00, 0x99, 0x00, 0x9D, 0x00,
                    0x13, 0x00, 0x06, 0x00, 0x03, 0x00, 0x18, 0x00, 0x09, 0x00, 0x9A, 0x00, 0x0F, 0x00, 0x9D, 0x00,
                    0x0B, 0x00, 0x0D, 0x00, 0x01, 0x00, 0x08, 0x00, 0x02, 0x00, 0x9F, 0x00, 0x11, 0x00, 0x9F, 0x00,
                    0x0B, 0x00, 0x0A, 0x00, 0x07, 0x00, 0x13, 0x00, 0x0E, 0x00, 0x9B, 0x00, 0x97, 0x00, 0x99, 0x00,
                    0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x95, 0x00, 0x91, 0x00, 0x0C, 0x00, 0x08, 0x00,
                    0x8B, 0x00, 0x87, 0x00, 0x0A, 0x00, 0x11, 0x00, 0x04, 0x00, 0x85, 0x00, 0x96, 0x00, 0xC5, 0x00,
                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x9F, 0x00, 0x1B, 0x00, 0x96, 0x00,
                    0x8D, 0x00, 0x1B, 0x00, 0x88, 0x00, 0x93, 0x00, 0x09, 0x00, 0x09, 0x00, 0x1C, 0x00, 0x10, 0x00,
                    0x11, 0x00, 0x9F, 0x00, 0x84, 0x00, 0x80, 0x00, 0x15, 0x00, 0x19, 0x00, 0x03, 0x00, 0x1A, 0x00,
                    0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x95, 0x00, 0x17, 0x00, 0x87, 0x00,
                    0x86, 0x00, 0x0A, 0x00, 0x85, 0x00, 0x88, 0x00, 0x06, 0x00, 0x1B, 0x00, 0x1A, 0x00, 0x16, 0x00,
                    0x02, 0x00, 0x9B, 0x00, 0x0E, 0x00, 0xB2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00,
                    0x02, 0x80, 0x02, 0x80, 0xBC, 0xAF, 0x00, 0x00, 0x04, 0x01, 0x00, 0x00, 0xC0, 0xB0, 0x00, 0x00,
                    0x08, 0x00, 0x00, 0x00, 0xD4, 0x11, 0x00, 0x00, 0x5F, 0x12, 0x00, 0x00, 0xD6, 0x12, 0x00, 0x00,
                    0x98, 0x14, 0x00, 0x00, 0xB0, 0x14, 0x00, 0x00, 0xF6, 0x16, 0x00, 0x00, 0x90, 0x1B, 0x00, 0x00,
                    0x26, 0x1C, 0x00, 0x00, 0xCD, 0x1D, 0x00, 0x00, 0x2D, 0x1F, 0x00, 0x00, 0x57, 0x1F, 0x00, 0x00,
                    0xB3, 0x2B, 0x00, 0x00, 0xD7, 0x38, 0x00, 0x00, 0xF4, 0x38, 0x00, 0x00, 0x11, 0x39, 0x00, 0x00,
                    0x2F, 0x39, 0x00, 0x00, 0x4E, 0x39, 0x00, 0x00, 0x6D, 0x39, 0x00, 0x00, 0x8C, 0x39, 0x00, 0x00,
                    0xAA, 0x39, 0x00, 0x00, 0xB0, 0x3B, 0x00, 0x00, 0xCD, 0x3B, 0x00, 0x00, 0xF7, 0x3C, 0x00, 0x00,
                    0x10, 0x45, 0x00, 0x00, 0x30, 0x45, 0x00, 0x00, 0xC9, 0x45, 0x00, 0x00, 0xF8, 0x45, 0x00, 0x00,
                    0xB8, 0x47, 0x00, 0x00, 0xD5, 0x47, 0x00, 0x00, 0x36, 0x50, 0x00, 0x00, 0x96, 0x50, 0x00, 0x00,
                    0x41, 0x51, 0x00, 0x00, 0x7B, 0x5C, 0x00, 0x00, 0x16, 0x60, 0x00, 0x00, 0x46, 0x60, 0x00, 0x00,
                    0xFD, 0x60, 0x00, 0x00, 0x8C, 0x61, 0x00, 0x00, 0xED, 0x61, 0x00, 0x00, 0x98, 0x62, 0x00, 0x00,
                    0x4D, 0x63, 0x00, 0x00, 0xDD, 0x63, 0x00, 0x00, 0x0E, 0x65, 0x00, 0x00, 0x2B, 0x65, 0x00, 0x00,
                    0x52, 0x66, 0x00, 0x00, 0x21, 0x67, 0x00, 0x00, 0x16, 0x68, 0x00, 0x00, 0x10, 0x69, 0x00, 0x00,
                    0xC7, 0x69, 0x00, 0x00, 0xE8, 0x69, 0x00, 0x00, 0xA8, 0x6D, 0x00, 0x00, 0xD4, 0x6F, 0x00, 0x00,
                    0x17, 0x70, 0x00, 0x00, 0x6F, 0x70, 0x00, 0x00, 0xCC, 0x70, 0x00, 0x00, 0x61, 0x71, 0x00, 0x00,
                    0x0A, 0x72, 0x00, 0x00, 0x09, 0x73, 0x00, 0x00, 0x58, 0x73, 0x00, 0x00, 0x91, 0x74, 0x00, 0x00,
                    0xF4, 0x74, 0x00, 0x00, 0x5D, 0x76, 0x00, 0x00, 0xB5, 0x76, 0x00, 0x00, 0xF7, 0x76, 0x00, 0x00,
                    0xCD, 0x79, 0x00, 0x00, 0xE7, 0x7A, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0xA0, 0x6B, 0x00, 0x00,
                    0x01, 0x05, 0x02, 0x00, 0x05, 0x74, 0x01, 0x00, 0x01, 0x04, 0x01, 0x00, 0x04, 0x42, 0x00, 0x00,
                    0x01, 0x1F, 0x0C, 0x00, 0x1F, 0x74, 0x16, 0x00, 0x1F, 0x64, 0x15, 0x00, 0x1F, 0x34, 0x14, 0x00,
                    0x1F, 0xD2, 0x18, 0xF0, 0x16, 0xE0, 0x14, 0xD0, 0x12, 0xC0, 0x10, 0x50, 0x01, 0x04, 0x01, 0x00,
                    0x04, 0x42, 0x00, 0x00, 0x01, 0x06, 0x02, 0x00, 0x06, 0x32, 0x02, 0x30, 0x01, 0x06, 0x02, 0x00,
                    0x06, 0x32, 0x02, 0x30, 0x01, 0x10, 0x06, 0x00, 0x10, 0x54, 0x0B, 0x00, 0x10, 0x34, 0x0A, 0x00,
                    0x10, 0x52, 0x0C, 0x60, 0x01, 0x06, 0x02, 0x00, 0x06, 0x32, 0x02, 0x30, 0x01, 0x0A, 0x04, 0x00,
                    0x0A, 0x34, 0x06, 0x00, 0x0A, 0x32, 0x06, 0x70, 0x01, 0x10, 0x06, 0x00, 0x10, 0x64, 0x0D, 0x00,
                    0x10, 0x34, 0x0C, 0x00, 0x10, 0x92, 0x0C, 0x70, 0x01, 0x06, 0x02, 0x00, 0x06, 0x72, 0x02, 0x30,
                    0x01, 0x17, 0x08, 0x00, 0x17, 0x74, 0x10, 0x00, 0x17, 0x64, 0x0F, 0x00, 0x17, 0x34, 0x0E, 0x00,
                    0x17, 0xB2, 0x10, 0x50, 0x01, 0x1A, 0x09, 0x00, 0x1A, 0x64, 0x2E, 0x00, 0x1A, 0x34, 0x2D, 0x00,
                    0x1A, 0x01, 0x28, 0x00, 0x0E, 0xE0, 0x0C, 0x70, 0x0B, 0x50, 0x00, 0x00, 0x01, 0x1C, 0x0B, 0x00,
                    0x1C, 0x34, 0x21, 0x00, 0x1C, 0x01, 0x16, 0x00, 0x10, 0xF0, 0x0E, 0xE0, 0x0C, 0xD0, 0x0A, 0xC0,
                    0x08, 0x70, 0x07, 0x60, 0x06, 0x50, 0x00, 0x00, 0x01, 0x14, 0x08, 0x00, 0x14, 0x64, 0x09, 0x00,
                    0x14, 0x54, 0x08, 0x00, 0x14, 0x34, 0x07, 0x00, 0x14, 0x32, 0x10, 0x70, 0x01, 0x17, 0x0A, 0x00,
                    0x17, 0x54, 0x0C, 0x00, 0x17, 0x34, 0x0B, 0x00, 0x17, 0x32, 0x13, 0xF0, 0x11, 0xE0, 0x0F, 0xD0,
                    0x0D, 0x70, 0x0C, 0x60, 0x01, 0x0A, 0x04, 0x00, 0x0A, 0x34, 0x07, 0x00, 0x0A, 0x32, 0x06, 0x70,
                    0x01, 0x18, 0x0A, 0x00, 0x18, 0x64, 0x0C, 0x00, 0x18, 0x54, 0x0B, 0x00, 0x18, 0x34, 0x0A, 0x00,
                    0x18, 0x52, 0x14, 0xF0, 0x12, 0xE0, 0x10, 0x70, 0x01, 0x06, 0x02, 0x00, 0x06, 0x32, 0x02, 0x30,
                    0x01, 0x1D, 0x0C, 0x00, 0x1D, 0x74, 0x0B, 0x00, 0x1D, 0x64, 0x0A, 0x00, 0x1D, 0x54, 0x09, 0x00,
                    0x1D, 0x34, 0x08, 0x00, 0x1D, 0x32, 0x19, 0xF0, 0x17, 0xE0, 0x15, 0xC0, 0x01, 0x06, 0x02, 0x00,
                    0x06, 0x32, 0x02, 0x30, 0x01, 0x06, 0x02, 0x00, 0x06, 0x52, 0x02, 0x30, 0x01, 0x23, 0x0B, 0x00,
                    0x23, 0x34, 0x76, 0x00, 0x23, 0x01, 0x6C, 0x00, 0x14, 0xF0, 0x12, 0xE0, 0x10, 0xD0, 0x0E, 0xC0,
                    0x0C, 0x70, 0x0B, 0x60, 0x0A, 0x50, 0x00, 0x00, 0x01, 0x1B, 0x0B, 0x00, 0x1B, 0x64, 0x4C, 0x00,
                    0x1B, 0x54, 0x4B, 0x00, 0x1B, 0x34, 0x4A, 0x00, 0x1B, 0x01, 0x46, 0x00, 0x14, 0xF0, 0x12, 0xE0,
                    0x10, 0x70, 0x00, 0x00, 0x01, 0x1C, 0x0C, 0x00, 0x1C, 0x64, 0x0D, 0x00, 0x1C, 0x54, 0x0C, 0x00,
                    0x1C, 0x34, 0x0B, 0x00, 0x1C, 0x32, 0x18, 0xF0, 0x16, 0xE0, 0x14, 0xD0, 0x12, 0xC0, 0x10, 0x70,
                    0x01, 0x14, 0x08, 0x00, 0x14, 0x64, 0x08, 0x00, 0x14, 0x54, 0x07, 0x00, 0x14, 0x34, 0x06, 0x00,
                    0x14, 0x32, 0x10, 0x70, 0x01, 0x0A, 0x04, 0x00, 0x0A, 0x74, 0x02, 0x00, 0x05, 0x34, 0x01, 0x00,
                    0x01, 0x24, 0x0B, 0x00, 0x24, 0x34, 0x73, 0x01, 0x24, 0x01, 0x6A, 0x01, 0x15, 0xF0, 0x13, 0xE0,
                    0x11, 0xD0, 0x0F, 0xC0, 0x0D, 0x70, 0x0C, 0x60, 0x0B, 0x50, 0x00, 0x00, 0x01, 0x21, 0x0B, 0x00,
                    0x21, 0x64, 0x91, 0x00, 0x21, 0x34, 0x8E, 0x00, 0x21, 0x01, 0x88, 0x00, 0x12, 0xF0, 0x10, 0xE0,
                    0x0E, 0xD0, 0x0C, 0x70, 0x0B, 0x50, 0x00, 0x00, 0x01, 0x0C, 0x02, 0x00, 0x0C, 0xF2, 0x02, 0x50,
                    0x01, 0x15, 0x08, 0x00, 0x15, 0x64, 0x11, 0x00, 0x15, 0x34, 0x10, 0x00, 0x15, 0x92, 0x0E, 0xF0,
                    0x0C, 0x70, 0x0B, 0x50, 0x01, 0x1B, 0x09, 0x00, 0x1B, 0x34, 0x95, 0x00, 0x1B, 0x01, 0x8E, 0x00,
                    0x0C, 0xF0, 0x0A, 0xE0, 0x08, 0x70, 0x07, 0x60, 0x06, 0x50, 0x00, 0x00, 0x01, 0x17, 0x09, 0x00,
                    0x17, 0x01, 0x28, 0x00, 0x0B, 0xF0, 0x09, 0xE0, 0x07, 0xC0, 0x05, 0x70, 0x04, 0x60, 0x03, 0x30,
                    0x02, 0x50, 0x00, 0x00, 0x01, 0x04, 0x01, 0x00, 0x04, 0x62, 0x00, 0x00, 0x01, 0x07, 0x01, 0x00,
                    0x07, 0xA2, 0x00, 0x00, 0x01, 0x15, 0x08, 0x00, 0x15, 0x01, 0x1F, 0x00, 0x09, 0xF0, 0x07, 0xE0,
                    0x05, 0x70, 0x04, 0x60, 0x03, 0x30, 0x02, 0x50, 0x01, 0x14, 0x07, 0x00, 0x14, 0x34, 0x1C, 0x00,
                    0x14, 0x01, 0x18, 0x00, 0x08, 0x70, 0x07, 0x60, 0x06, 0x50, 0x00, 0x00, 0x01, 0x0F, 0x06, 0x00,
                    0x0F, 0x64, 0x0B, 0x00, 0x0F, 0x34, 0x0A, 0x00, 0x0F, 0x72, 0x0B, 0x70, 0x01, 0x23, 0x0B, 0x00,
                    0x23, 0x34, 0x40, 0x01, 0x23, 0x01, 0x36, 0x01, 0x14, 0xF0, 0x12, 0xE0, 0x10, 0xD0, 0x0E, 0xC0,
                    0x0C, 0x70, 0x0B, 0x60, 0x0A, 0x50, 0x00, 0x00, 0x01, 0x0A, 0x04, 0x00, 0x0A, 0x34, 0x0A, 0x00,
                    0x0A, 0x72, 0x06, 0x70, 0x01, 0x0D, 0x04, 0x00, 0x0D, 0x34, 0x11, 0x00, 0x0D, 0xD2, 0x06, 0x50,
                    0x01, 0x0D, 0x04, 0x00, 0x0D, 0x34, 0x0E, 0x00, 0x0D, 0xB2, 0x06, 0x50, 0x01, 0x0A, 0x04, 0x00,
                    0x0A, 0x34, 0x08, 0x00, 0x0A, 0x52, 0x06, 0x70, 0x01, 0x17, 0x08, 0x00, 0x17, 0x74, 0x10, 0x00,
                    0x17, 0x64, 0x0F, 0x00, 0x17, 0x34, 0x0E, 0x00, 0x17, 0xB2, 0x10, 0x50, 0x01, 0x19, 0x0B, 0x00,
                    0x19, 0x74, 0x07, 0x00, 0x19, 0x64, 0x06, 0x00, 0x19, 0x54, 0x05, 0x00, 0x19, 0x34, 0x04, 0x00,
                    0x19, 0xF0, 0x17, 0xE0, 0x15, 0xC0, 0x00, 0x00, 0x01, 0x05, 0x02, 0x00, 0x05, 0x34, 0x01, 0x00,
                    0x01, 0x18, 0x0A, 0x00, 0x18, 0x64, 0x0A, 0x00, 0x18, 0x54, 0x09, 0x00, 0x18, 0x34, 0x08, 0x00,
                    0x18, 0x32, 0x14, 0xF0, 0x12, 0xE0, 0x10, 0x70, 0x01, 0x0F, 0x06, 0x00, 0x0F, 0x64, 0x07, 0x00,
                    0x0F, 0x34, 0x06, 0x00, 0x0F, 0x32, 0x0B, 0x70, 0x01, 0x14, 0x08, 0x00, 0x14, 0x64, 0x08, 0x00,
                    0x14, 0x54, 0x07, 0x00, 0x14, 0x34, 0x06, 0x00, 0x14, 0x32, 0x10, 0x70, 0x01, 0x05, 0x02, 0x00,
                    0x05, 0x34, 0x01, 0x00, 0x01, 0x06, 0x02, 0x00, 0x06, 0x32, 0x02, 0x30, 0x01, 0x06, 0x02, 0x00,
                    0x06, 0xB2, 0x02, 0x30, 0x01, 0x10, 0x04, 0x00, 0x10, 0x34, 0x12, 0x00, 0x10, 0xF2, 0x06, 0x50,
                    0x01, 0x1F, 0x0B, 0x00, 0x1F, 0x34, 0x66, 0x00, 0x1F, 0x01, 0x5E, 0x00, 0x10, 0xF0, 0x0E, 0xE0,
                    0x0C, 0xD0, 0x0A, 0xC0, 0x08, 0x70, 0x07, 0x60, 0x06, 0x50, 0x00, 0x00, 0x01, 0x1B, 0x0B, 0x00,
                    0x1B, 0x64, 0x4B, 0x00, 0x1B, 0x54, 0x4A, 0x00, 0x1B, 0x34, 0x48, 0x00, 0x1B, 0x01, 0x44, 0x00,
                    0x14, 0xF0, 0x12, 0xE0, 0x10, 0x70, 0x00, 0x00, 0x01, 0x10, 0x06, 0x00, 0x10, 0x64, 0x0B, 0x00,
                    0x10, 0x34, 0x0A, 0x00, 0x10, 0x52, 0x0C, 0x70, 0x01, 0x13, 0x08, 0x00, 0x13, 0x34, 0x0F, 0x00,
                    0x13, 0x52, 0x0C, 0xF0, 0x0A, 0xE0, 0x08, 0x70, 0x07, 0x60, 0x06, 0x50, 0x01, 0x1E, 0x0B, 0x00,
                    0x1E, 0x64, 0x1F, 0x00, 0x1E, 0x34, 0x1C, 0x00, 0x1E, 0x01, 0x16, 0x00, 0x12, 0xF0, 0x10, 0xE0,
                    0x0E, 0xC0, 0x0C, 0x70, 0x0B, 0x50, 0x00, 0x00, 0x01, 0x0A, 0x04, 0x00, 0x0A, 0x34, 0x0A, 0x00,
                    0x0A, 0x72, 0x06, 0x70, 0x01, 0x1A, 0x09, 0x00, 0x1A, 0x64, 0x1B, 0x00, 0x1A, 0x34, 0x1A, 0x00,
                    0x1A, 0x01, 0x16, 0x00, 0x0E, 0xF0, 0x0C, 0x70, 0x0B, 0x50, 0x00, 0x00, 0x01, 0x27, 0x0D, 0x00,
                    0x27, 0x74, 0x2D, 0x00, 0x27, 0x64, 0x2C, 0x00, 0x27, 0x34, 0x2B, 0x00, 0x27, 0x01, 0x24, 0x00,
                    0x1C, 0xF0, 0x1A, 0xE0, 0x18, 0xD0, 0x16, 0xC0, 0x14, 0x50, 0x00, 0x00, 0x01, 0x14, 0x08, 0x00,
                    0x14, 0x64, 0x0A, 0x00, 0x14, 0x54, 0x09, 0x00, 0x14, 0x34, 0x08, 0x00, 0x14, 0x52, 0x10, 0x70,
                    0x01, 0x17, 0x07, 0x00, 0x17, 0x74, 0x21, 0x00, 0x17, 0x34, 0x20, 0x00, 0x17, 0x01, 0x1E, 0x00,
                    0x0B, 0x50, 0x00, 0x00, 0x01, 0x23, 0x0D, 0x00, 0x23, 0xC4, 0x27, 0x00, 0x23, 0x74, 0x26, 0x00,
                    0x23, 0x64, 0x25, 0x00, 0x23, 0x34, 0x24, 0x00, 0x23, 0x01, 0x20, 0x00, 0x18, 0xF0, 0x16, 0xE0,
                    0x14, 0x50, 0x00, 0x00, 0x01, 0x12, 0x06, 0x00, 0x12, 0x64, 0x11, 0x00, 0x12, 0x34, 0x0E, 0x00,
                    0x12, 0xB2, 0x0B, 0x50, 0x01, 0x1B, 0x09, 0x00, 0x1B, 0x74, 0x1A, 0x00, 0x1B, 0x64, 0x19, 0x00,
                    0x1B, 0x34, 0x18, 0x00, 0x1B, 0x01, 0x16, 0x00, 0x10, 0x50, 0x00, 0x00, 0x01, 0x11, 0x03, 0x00,
                    0x11, 0x01, 0x4A, 0x02, 0x02, 0x50, 0x00, 0x00, 0x01, 0x10, 0x06, 0x00, 0x10, 0x64, 0x08, 0x00,
                    0x10, 0x34, 0x07, 0x00, 0x10, 0x32, 0x0C, 0x70, 0x01, 0x14, 0x08, 0x00, 0x14, 0x64, 0x08, 0x00,
                    0x14, 0x54, 0x07, 0x00, 0x14, 0x34, 0x06, 0x00, 0x14, 0x32, 0x10, 0x70, 0x01, 0x15, 0x08, 0x00,
                    0x15, 0x64, 0x0D, 0x00, 0x15, 0x34, 0x0C, 0x00, 0x15, 0x72, 0x0E, 0xE0, 0x0C, 0x70, 0x0B, 0x50,
                    0x01, 0x1F, 0x0C, 0x00, 0x1F, 0x74, 0x15, 0x00, 0x1F, 0x64, 0x14, 0x00, 0x1F, 0x34, 0x13, 0x00,
                    0x1F, 0xB2, 0x18, 0xF0, 0x16, 0xE0, 0x14, 0xD0, 0x12, 0xC0, 0x10, 0x50, 0x01, 0x16, 0x07, 0x00,
                    0x16, 0x01, 0x64, 0x00, 0x07, 0xE0, 0x05, 0x70, 0x04, 0x60, 0x03, 0x30, 0x02, 0x50, 0x00, 0x00,
                    0x01, 0x12, 0x06, 0x00, 0x12, 0x74, 0x13, 0x00, 0x12, 0x34, 0x10, 0x00, 0x12, 0xD2, 0x0B, 0x50,
                    0x01, 0x0C, 0x06, 0x00, 0x0C, 0x34, 0x0E, 0x00, 0x0C, 0x72, 0x08, 0x70, 0x07, 0x60, 0x06, 0x50,
                    0x01, 0x17, 0x0A, 0x00, 0x17, 0x54, 0x11, 0x00, 0x17, 0x34, 0x10, 0x00, 0x17, 0x92, 0x13, 0xF0,
                    0x11, 0xE0, 0x0F, 0xC0, 0x0D, 0x70, 0x0C, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
                ]
            r13d = 1
            r8d = r13d
            edx = r13d+4
            unk_13FDEBC38 = [0x0C, 0x00, 0xCF, 0x00, 0x00, 0x00, 0xC3, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
            rax = sub_13FDE67D4(unk_13FDEBC38,5,1,binar)
            edx = 0x108
            rcx = [0x33, 0x00, 0x33, 0x00, 0x61, 0x00, 0x65, 0x00, 0x39, 0x00, 0x31, 0x00, 0x36, 0x00, 0x63, 0x00,
                0x63, 0x00, 0x35, 0x00, 0x34, 0x00, 0x66, 0x00, 0x35, 0x00, 0x61, 0x00, 0x36, 0x00, 0x36, 0x00,
                0x00, 0x00, 0x65, 0x00, 0x78, 0x00, 0x65, 0x00] # this corresponds to 33ae916cc54f5a66.exe
            r9d = edx
            r8d = rcx
            
            new_s = ""
            for i in range(0,len(rcx),2):
                new_s += chr(rcx[i])
            print(new_s)
            for i in range(0,len(rax)):
                new_s = replace_str_index(new_s,i,rax[i])
            r8d = new_s[3:]
            #print(r8d)
            rcx = new_s
            rax = new_s
            #print(rax)
            res = (re.sub('.', lambda x: r'%04X' % ord(x.group()), rax))
            #print(res)
            r8 = "C:\\Windows\\SYSTEM32\\ntdll.dll"
            #my_wcsncat(res[2:],r8,0x108)
            """
            pana cand apuc sa lucrez cu danii sa emulz kkt ila fac manual concatenare
            """
            rax = new_s[0:4]+r8
            print(rax)
            print(hex(len(rax)))
            rcx = rax   
            v15 = [None for i in range(len(rax))]
            v15_1 =  [None for i in range(len(rax)+1)]
            y = "dece0771658c"
            z = "f9518e4f80499d93d8c5a1eddece0771658c"
            z = "0"+z[2:]
            print(z)
            z = z[0:3]+z[7:]
            print(z)
            x = "d68f668b4240f9518e4f80499d93d8c5a1eddece0771658c33ae916cc54f5a66"
            pos = x.find(y)
            r9 = x[pos:(pos+len(y))]+rax
            print(r9)
            pos = x.find(z)
            r8 = x[pos:(pos+len(z))]+rax
            print(r8)
            rax = len(rax)+1
            v19 = v15
            rdx = 1
            rax = "BDdl"
            z = z[3:7]+"@"+z[9:]
            print(z)
            z="xxxx"+z[4:]
            print(z)
            k=z
            z = z[0:7]+z[17:19]+z[len(z)-4:len(z)]
            print(z)
            #ntcreatefile syscall now, dece0771658c\??PC:\Windows\SYSTEM32\ntdll.dll as argument
            dp = Dumpulator("blacklotus.dmp")
            current_modules = []
            modules = dp.modules._name_lookup
            print(dir(dp))
            for key in modules:
                if not 'C:' in key:
                    current_modules.append(key)
            current_modules = current_modules[1:]
            print(current_modules)
            flag = 0 
            i = 0
            while(True):
                v13 = pe_heder[pe_heder[0x14]:]
                #print(hexdump(v13))
                print("====================================================") 
                r14 = v13[i+2:]
                #print(hexdump(r14))
                rcx = r14[22:27]
                rcx = "".join(map(chr, rcx))
                print("====================================================") 
                #print(hexdump(rcx))
                print((rcx))
                print(hex(some_hash_0x1003F(rcx)))
                #if(some_hash_0x1003F(rcx) == 0x7BC3E49B):
                #    break
                eax = int.from_bytes(r14[0x22:0x26],"little")
                #print(hexdump(binar[eax:]))
                rcx = -1
                eax = v13
                i+=1
                break
    return r8

if __name__ == "__main__":
    path = get_ntdll_and_unhook2(0xD22E2014)
    ntdll_base = 0x13f280000 # use this as constant for now it is what it is 
    binar = open(sys.argv[1],"rb").read()
    qword_7FF603B1F600 = aplib_decompress(ntdll_base,binar, 0xB08469DD, path)
    qword_13F2FF5E0 = aplib_decompress(ntdll_base,binar, 0xC8D8F9F4, path)
    qword_13F2FF5E8 = aplib_decompress(ntdll_base,binar, 0xF6CFC604, path)
    qword_13F2FF5F0 = aplib_decompress(ntdll_base,binar, 0x572D53D3, path)
    qword_13F2FF5F8 = aplib_decompress(ntdll_base,binar, 0x10DE9522, path)
    qword_13F2FF610 = aplib_decompress(ntdll_base,binar, 0xBB26CCEB, path)
    qword_13F2FF608 = aplib_decompress(ntdll_base,binar, 0x89AB8454, path)
    qword_13F2FF618 = aplib_decompress(ntdll_base,binar, 0xB2AECB6A, path)
    qword_13F2FF6C0 = aplib_decompress(ntdll_base,binar, 0xF0238EA7, path)
    qword_13F2FF740 = aplib_decompress(ntdll_base,binar, 0x839101F2, path)
    qword_13F2FF750 = aplib_decompress(ntdll_base,binar, 0x319CEA81, path)
    qword_13F2FF758 = aplib_decompress(ntdll_base,binar, 0xC96D110C, path)
    result = aplib_decompress(ntdll_base,binar, 0xEF508FE, path)
